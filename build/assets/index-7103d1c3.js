(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();const Rt=class Rt{constructor(t,e){this.variant=t,this.spriteLoader=e,this.base=this.loadSprite("base"),this.hover=this.loadSprite("hover")}loadSprite(t){return this.spriteLoader.loadImagePNG(Rt.PATH,this.variant,t)}static DefaultButton(t){return new Rt("default",t)}static OutstandingButton(t){return new Rt("outstanding",t)}};Rt.PATH="ui/buttons";let Se=Rt;const Re=class Re{constructor(t){this.spriteLoader=t,this.base=this.loadSprite("base"),this.active=this.loadSprite("active")}loadSprite(t){return this.spriteLoader.loadImagePNG(Re.PATH,t)}};Re.PATH="ui/edit_icon";let ti=Re;const ve=class ve{static Explosion(t){return t.loadImageListInPNG(ve.EXPLOSION_FRAMES_LENGTH,"effects/explosion")}};ve.EXPLOSION_FRAMES_LENGTH=10;let ei=ve;const H=class H{constructor(t,e){this.moving=e.loadImageListInPNG(H.MOVING_FRAMES,H.PATH,t),this.fire=e.loadImagePNG(H.PATH,t,"fire")}static WeakEnemy(t){return new H("enemy_weak",t)}static RegularEnemy(t){return new H("enemy_regular",t)}static StrongEnemy(t){return new H("enemy_strong",t)}static EnemyLaser(t){return t.loadImagePNG(H.PATH,"laser")}};H.MOVING_FRAMES=3,H.PATH="enemies";let yt=H;const It=class It{constructor(t,e,i){this.variant=t,this.size=e,this.spriteLoader=i,this.base=this.loadSprite("base"),this.hover=this.loadSprite("hover")}loadSprite(t){return this.spriteLoader.loadImagePNG(It.PATH,this.variant,this.size,t)}static DefaultKey(t){return new It("default","small",t)}static OutstandingKey(t){return new It("outstanding","small",t)}static OutstandingLargeKey(t){return new It("outstanding","large",t)}};It.PATH="ui/keyboard_input_keys";let Wt=It;const Ce=class Ce{constructor(t){this.spriteLoader=t,this.large=this.loadSprite("large"),this.small=this.loadSprite("small")}loadSprite(t){return this.spriteLoader.loadImagePNG(Ce.PATH,t)}};Ce.PATH="ui/keys";let ii=Ce;const xe=class xe{constructor(t){this.spriteLoader=t,this.first=this.loadSprite("first"),this.second=this.loadSprite("second"),this.third=this.loadSprite("third")}loadSprite(t){return this.spriteLoader.loadImagePNG(xe.PATH,t)}};xe.PATH="scoremedals";let si=xe;const De=class De{constructor(t){this.spriteLoader=t,this.noDamage=this.loadSprite("no_damage"),this.damaged=this.loadSprite("damaged"),this.veryDamaged=this.loadSprite("very_damaged")}loadSprite(t){return this.spriteLoader.loadImagePNG(De.PATH,t)}};De.PATH="shield";let ri=De;const tt=class tt{constructor(t,e){const i=e.loadImageListInPNG(tt.MOVING_FRAMES,tt.PATH,t);this.idle=[i[0],i[1]],this.moving=[i[1],i[2]],this.laser=e.loadImagePNG(tt.PATH,t,"laser")}static ShipOne(t){return new tt("ship_one",t)}static ShipTwo(t){return new tt("ship_two",t)}};tt.MOVING_FRAMES=3,tt.PATH="ships";let Ie=tt;const Xt=class Xt{constructor(t){this.spriteLoader=t,this.base=this.loadSprite("base"),this.hover=this.loadSprite("hover")}loadSprite(t){return this.spriteLoader.loadImagePNG(Xt.PATH,t)}static SplashLogo(t){return new Xt(t)}};Xt.PATH="ui/splash_logo";let ni=Xt;function Gi(r){return`/invasores_p_web_sandbox/${r}`}const Fe=class Fe{getSpritePath(...t){return`${Fe.SPRITES_ROOT}/${t.join("/")}`}loadImage(t){const e=new Image;return e.src=t,e}loadImagePNG(...t){return this.loadImage(`${this.getSpritePath(...t)}.png`)}loadImageListInPNG(t,...e){const i=Array(t);for(let s=0;s<i.length;s++)i[s]=this.loadImagePNG(...e,s.toString());return i}};Fe.SPRITES_ROOT=Gi("sprites");let ai=Fe;const jt=class jt{static Title(t){return t.loadImagePNG("ui/title")}static WebEditionTag(t){return t.loadImagePNG("ui/web_edition_tag")}static Pause(t){return t.loadImagePNG("ui/pause")}static GameOver(t){return t.loadImagePNG("ui/game_over")}static NPCShipOne(t){return t.loadImageListInPNG(jt.MODE_BUTTON_SHIP_LENGTH,"ui/npcs/ship_one")}static NPCShipTwo(t){return t.loadImageListInPNG(jt.MODE_BUTTON_SHIP_LENGTH,"ui/npcs/ship_two")}static PlayerSelector(t){return t.loadImagePNG("ui/player_selector")}};jt.MODE_BUTTON_SHIP_LENGTH=3;let q=jt;class bi{constructor(){const t=new ai;this.SPLASH_LOGO=ni.SplashLogo(t),this.SHIP_ONE=Ie.ShipOne(t),this.SHIP_TWO=Ie.ShipTwo(t),this.PLAYER_SELECTOR=q.PlayerSelector(t),this.WEAK_ENEMY=yt.WeakEnemy(t),this.REGULAR_ENEMY=yt.RegularEnemy(t),this.STRONG_ENEMY=yt.StrongEnemy(t),this.ENEMY_LASER=yt.EnemyLaser(t),this.SHIELD=new ri(t),this.EXPLOSION=ei.Explosion(t),this.TITLE=q.Title(t),this.WEB_EDITION_TAG=q.WebEditionTag(t),this.PAUSE=q.Pause(t),this.GAME_OVER=q.GameOver(t),this.DEFAULT_BUTTON_SPRITES=Se.DefaultButton(t),this.OUTSTANDING_BUTTON_SPRITES=Se.OutstandingButton(t),this.KEY_SPRITES=new ii(t),this.NPC_SHIP_ONE=q.NPCShipOne(t),this.NPC_SHIP_TWO=q.NPCShipTwo(t),this.SCORE_MEDALS=new si(t),this.EDIT_ICONS=new ti(t),this.KEYBOARD_INPUT_KEY_DEFAULT=Wt.DefaultKey(t),this.KEYBOARD_INPUT_KEY_OUTSTANDING=Wt.OutstandingKey(t),this.KEYBOARD_INPUT_KEY_OUTSTANDING_LARGE=Wt.OutstandingLargeKey(t)}static async create(){const t=new bi;return await Promise.all(t.getAllImages().map(e=>new Promise(i=>{e.addEventListener("load",()=>i())}))),t}getAllImages(){return Object.values(this).map(e=>e instanceof HTMLImageElement?e:typeof e=="object"&&!Array.isArray(e)?Object.values(e):e).flat(1/0).filter(e=>e instanceof HTMLImageElement)}}class d{static async init(){d._spriteManager=await bi.create()}static get spriteManager(){return d._spriteManager}}class y{constructor(t,e){this.action=t,this.timeout=e,this.nowTime=0,this.lastTime=0,this.elapsedTime=0,this.stopped=!0}update(){if(this.checkPastTimeout()){this.pastTimeout();return}this.stopped||(this.nowTime=performance.now(),this.elapsedTime+=this.nowTime-this.lastTime,this.lastTime=this.nowTime)}checkPastTimeout(){return this.elapsedTime>=this.timeout}start(){this.stopped=!1,this.elapsedTime=0,this.lastTime=performance.now()}stop(){this.stopped=!0}get isStopped(){return this.stopped}pastTimeout(){this.elapsedTime=0,this.action()}}var zi=(r=>(r.Retron2000="Retron2000",r))(zi||{}),Vi=(r=>(r.Spanish="es",r.English="en",r))(Vi||{});const T=class T{};T.DEFAULT_LANG=Vi.Spanish,T.DEFAULT_FONT=zi.Retron2000,T.DEFAULT_SOUNDTRACK_VOLUME=.5,T.SHIELD_DAMAGE_CAPACITY=9,T.WEAK_ENEMY_DAMAGE_CAPACITY=3,T.REGULAR_ENEMY_DAMAGE_CAPACITY=4,T.STRONG_ENEMY_DAMAGE_CAPACITY=5,T.WINNING_PLAYER_LIFE_INCREMENT=1,T.PLAYER_DAMAGE_CAPACITY=5,T.WEAK_ENEMY_SCORE_POINTS=80,T.REGULAR_ENEMY_SCORE_POINTS=100,T.STRONG_ENEMY_SCORE_POINTS=120,T.TOP_SCORE_COUNT=3,T.LATEST_SCORE_COUNT=5,T.GAME_SCENE_BACKGROUND_SPEED=6,T.GAME_MENU_SCENE_BACKGROUND_SPEED=2,T.NICKNAME_MAX_LENGTH=15,T.PLAYER_LASER_TAG="player",T.ENEMY_LASER_TAG="enemy";let u=T;var ae=(r=>(r[r.Muted=0]="Muted",r[r.Blurred=.1]="Blurred",r[r.Default=u.DEFAULT_SOUNDTRACK_VOLUME]="Default",r))(ae||{});const He=class He{constructor(t){this.audio=t,this.timer=new y(()=>this.volumeInterpolation&&this.volumeInterpolation(),He.INTERVAL_INTERPOLATION_VOLUME),this.currentTargetVolume=null}update(){this.timer.update()}setVolume(t){if(t===this.currentTargetVolume)return;this.currentTargetVolume=t;const e=this.audio.volume,i=(t-e)/this.timer.timeout,s=n=>i>0?n>=t:n<=t;this.volumeInterpolation=()=>{let n=this.audio.volume+i;n=parseFloat(n.toFixed(3)),s(n)&&(n=t,this.volumeInterpolation=void 0,this.timer.stop()),this.audio.volume=n},this.timer.start()}restoreVolume(){this.audio.volume=ae.Default,this.currentTargetVolume=this.audio.volume}};He.INTERVAL_INTERPOLATION_VOLUME=10;let hi=He;class ws{constructor(t,e){this.fileName=t,this.audio=new Audio(Gi(`soundtrack/${t}.${e}`)),this.audio.preload="auto",this.audio.loop=!0,this.volumeController=new hi(this.audio)}update(){this.volumeController.update()}play(){this.volumeController.restoreVolume(),this.audio.play()}stop(){this.audio.pause(),this.audio.currentTime=0}}const $t=class $t{static Create(t,e){let i=this.soundtrackMap.get(t);return i||(i=new ws(t,e),this.soundtrackMap.set(i.fileName,i),i)}static async init(){const t=Array.from(this.soundtrackMap.values()).map(e=>$t.load(e));await Promise.all(t)}addSoundtrack(t){$t.soundtrackMap.set(t.fileName,t)}static load(t){return new Promise(e=>{t.audio.addEventListener("canplaythrough",()=>e())})}};$t.soundtrackMap=new Map;let he=$t;class a{constructor(t,e){this.x=t,this.y=e}static Horizontal(t){return new a(t,0)}static Vertical(t){return new a(0,t)}static get Zero(){return new a(0,0)}sum(t){return new a(this.x+t.x,this.y+t.y)}diff(t){return new a(this.x-t.x,this.y-t.y)}getMagnitude(){return Math.sqrt(this.x**2+this.y**2)}copy(){return new a(this.x,this.y)}}const B=class B{constructor(){this.canvas=document.getElementById("game"),this.renderizer=this.canvas.getContext("2d"),this.setupDimensions()}static getInstance(){return B.instance||(B.instance=new B),B.instance}setupDimensions(){this.canvasSize={width:B.SCREEN_MEASURE*B.ASPECT_RATIO,height:B.SCREEN_MEASURE},this.adjustCanvasElementSize(),window.addEventListener("resize",()=>this.adjustCanvasElementSize())}adjustCanvasElementSize(){const{width:t,height:e}=document.documentElement.getBoundingClientRect();this.canvas.style.width="unset",this.canvas.style.height=`${e}px`,this.canvas.clientWidth>t&&(this.canvas.style.width=`${t}px`,this.canvas.style.height="unset"),this.canvas.clientHeight>e&&(this.canvas.style.width="unset",this.canvas.style.height=`${e}px`)}set canvasSize({width:t,height:e}){this.canvas.width=t,this.canvas.height=e}get canvasSize(){return{width:this.canvas.width,height:this.canvas.height}}get halfScreenWidth(){return this.getMeasureByScreenWidth(.5)}get halfScreenHeight(){return this.getMeasureByScreenHeight(.5)}getPositionByScreen(t,e){return new a(this.getMeasureByScreenWidth(t),this.getMeasureByScreenHeight(e))}getCenterPosition(t){return this.getPositionByScreen(.5,.5).diff(new a(t.width*.5,t.height*.5))}getMeasureByScreenWidth(t){return this.canvas.width*t}getMeasureByScreenHeight(t){return this.canvas.height*t}clearScreen(){const t=this.canvasSize,{renderizer:e}=this;e.fillStyle="#000000",e.fillRect(0,0,t.width,t.height)}setOpacity(t,e){this.renderizer.globalAlpha=t,e(),this.renderizer.globalAlpha=1}};B.ASPECT_RATIO=16/9,B.SCREEN_MEASURE=700;let o=B;var c=(r=>(r.FPS="#ffff00",r.Dark="#000000",r.Light="#ffffff",r.Space="#0f0614",r.Highlighted="#4EFF21",r.Overlay="#000000aa",r.LatestScore="#C1FFC3",r.FirstScore="#4EE995",r.SecondScore="#E2FF6F",r.ThirdScore="#FF6F6F",r.HighlightedSoftText="#D5FFD7",r.OutstandingText="#E9E9AA",r.PlayerHUD="#6DE4A4",r))(c||{});class ft{constructor(){this.implementationIds=new Set,this.renderProvider=o.getInstance()}static getInstance(){return ft.instance||(ft.instance=new ft),ft.instance}addListener(t){this.implementationIds.add(t)}removeListener(t){this.implementationIds.delete(t)}hasListener(t){return this.implementationIds.has(t)}update(){this.renderProvider.canvas.style.cursor=this.implementationIds.size>0?"pointer":"default"}}class Nt{constructor(){this._position=a.Zero,this.canvas=o.getInstance().canvas,this.clickListeners=new Map,this.canvas.addEventListener("mousemove",t=>{const e=this.canvas.width/this.canvas.clientWidth,i=this.canvas.height/this.canvas.clientHeight;this._position=new a((t.clientX-this.canvas.offsetLeft)*e,(t.clientY-this.canvas.offsetTop)*i)})}static getInstance(){return Nt.instance||(Nt.instance=new Nt),Nt.instance}get position(){return this._position}addClickListener(t,e){this.clickListeners.set(t,e),this.canvas.addEventListener("click",e)}removeClickListener(t){this.clickListeners.has(t)&&(this.canvas.removeEventListener("click",this.clickListeners.get(t)),this.clickListeners.delete(t))}}class Je{constructor(t,e,i){this.position=t,this.size=e,this.id=crypto.randomUUID(),this._isHover=!1,this.isDisabled=!1,this.mouseManager=Nt.getInstance(),this.mouseManager.addClickListener(this.id,()=>{this.isHover&&i(this)}),this.cursorMouseManager=ft.getInstance()}set padding({left:t=0,right:e=0,top:i=0,bottom:s=0}){this.position.x-=t,this.position.y-=i,this.size.width+=e,this.size.height+=s}get isHover(){return this._isHover}removeClickListener(){this.mouseManager.removeClickListener(this.id),this.cursorMouseManager.removeListener(this.id)}checkIsHover(){const t=this.mouseManager.position;this._isHover=!this.isDisabled&&t.x>=this.position.x&&t.x<=this.position.x+this.size.width&&t.y>=this.position.y&&t.y<=this.position.y+this.size.height}update(){this.checkIsHover(),this.isHover?this.cursorMouseManager.addListener(this.id):this.cursorMouseManager.hasListener(this.id)&&this.cursorMouseManager.removeListener(this.id)}}const k=class k{constructor(t,e,i,s){this._content=t,this.color=e,this.fontSize=i,this.renderProvider=o.getInstance(),this._position=s,this._alignment=k.DEFAULT_ALIGNMENT,this._opacity=1}static NewTextContentWithDefaultSize(t,e,i){return new k(t,e,k.DEFAULT_FONT_SIZE,i)}render(){const{renderizer:t}=this.renderProvider;t.font=this.getFont(this.fontSize),t.fillStyle=this.color,this.writeText()}get opacity(){return this._opacity}set opacity(t){if(t<0)throw new Error("Only numbers be greater or equal to 0");this._opacity=t}getTextWidth(){const{_content:t,fontSize:e}=this,{renderizer:i}=this.renderProvider,s=this.getTextLineLongest(t),n=i.font;i.font=this.getFont(e);const{width:h}=i.measureText(s);return i.font=n,h}getTextLineLongest(t){return t.split(`
`).sort((i,s)=>s.length-i.length)[0]}getFont(t){return`${t}px ${u.DEFAULT_FONT}`}writeText(){const{renderizer:t}=this.renderProvider,{fontSize:e,position:i}=this,s=this.getTextLines(),n=e+k.LINE_HEIGHT,h=this.getTotalHeight(s,n);let l=i.y-h;this.renderProvider.setOpacity(this.opacity,()=>{s.forEach(p=>{t.textAlign=this._alignment,t.fillText(p,i.x,l+e*.5),l+=n})}),t.textAlign=k.DEFAULT_ALIGNMENT}getTextLines(){return this._content.split(`
`)}getTotalHeight(t,e){return e*t.length*.5-e*.5}getLineCount(){return this.getTextLines().length}get width(){return this.getTextWidth()}get height(){const t=this.getLineCount(),e=this.fontSize*t,i=k.LINE_HEIGHT*(t-1);return e+i}set content(t){this._content=t}get position(){return this._position}set position(t){this._position=t}set alignment(t){this._alignment=t}addOffset(t){this._position=this._position.sum(t)}};k.DEFAULT_FONT_SIZE=20,k.DEFAULT_ALIGNMENT="left",k.LINE_HEIGHT=8;let g=k;class os{constructor(t,e,i){this.size=e,this.textContent=i,this._position=t,this.renderProvider=o.getInstance(),this.centerPosition()}get position(){return this._position}get x(){return this.position.x}get y(){return this.position.y}get right(){return this.x+this.size.width}get bottom(){return this.y+this.size.height}get width(){return this.size.width}get height(){return this.size.height}centerPosition(){this.textContent.addOffset(new a(this.size.width*.5-this.textContent.width*.5,this.size.height*.5))}}const Be=class Be extends os{constructor(t,e,i,s,n){super(t,s.value,new g(e,c.Light,s.value.height*Be.FONT_SIZE_RATIO_BY_HEIGHT,t.copy())),this.sprites=i.sprites,this.sprite=this.sprites.base,this.mouseAdapter=new Je(t,s.value,()=>n(this))}get bottom(){return this.position.y+this.size.height}get top(){return this.position.y}get isHover(){return this.mouseAdapter.isHover}set isDisabled(t){this.mouseAdapter.isDisabled=t}removeClickListener(){this.mouseAdapter.removeClickListener()}update(){this.mouseAdapter.update(),this.sprite=this.mouseAdapter.isHover?this.sprites.hover:this.sprites.base}render(){const{renderizer:t}=this.renderProvider;this.renderProvider.setOpacity(this.mouseAdapter.isDisabled?.5:1,()=>{t.drawImage(this.sprite,this.position.x,this.position.y,this.size.width,this.size.height)}),this.textContent.render()}};Be.FONT_SIZE_RATIO_BY_HEIGHT=.28;let W=Be;class D{constructor(t,e){this._width=t,this._height=e}get width(){return this._width}set width(t){if(t<0)throw new Error("Invalid width");this._width=t}get height(){return this._height}set height(t){if(t<0)throw new Error("Invalid height");this._height=t}}class F{constructor(t){this.value=t}static get Small(){return new F(new D(130,58))}static get Medium(){return new F(new D(230,70))}}class v{constructor(t){this.sprites=t}static get Default(){return new v(d.spriteManager.DEFAULT_BUTTON_SPRITES)}static get Outstanding(){return new v(d.spriteManager.OUTSTANDING_BUTTON_SPRITES)}}const Jt=class Jt{constructor(t,e,i,s,n){this.button=new W(s,t,i.buttonVariant,F.Medium,h=>{n(h),h.removeClickListener()}),this.text=Jt.Description(e,i.descriptionColor,s,this.button)}static Description(t,e,i,s){const n=new g(t,e,14,i.copy());return n.addOffset(new a(s.width*.5,s.height+n.height*.5+Jt.VERTICAL_GAP)),n.alignment="center",n}get height(){return this.text.height}update(){this.button.update(),this.text.opacity=this.button.isHover?1:.5}render(){this.button.render(),this.text.render()}};Jt.VERTICAL_GAP=20;let fe=Jt;class oe{constructor(t,e){this.buttonVariant=t,this.descriptionColor=e}static get Default(){return new oe(v.Default,c.HighlightedSoftText)}static get Outstanding(){return new oe(v.Outstanding,c.OutstandingText)}}class cs{constructor(){this.currentScene=null}changeScene(t){this.currentScene=t}update(){var t;(t=this.currentScene)==null||t.update()}render(){var t;(t=this.currentScene)==null||t.render()}}class w extends cs{constructor(){super()}static getInstance(){return w.instance||(w.instance=new w),w.instance}}class Ot{constructor(t,e){this.frames=t,this.indexCurrentFrame=0,this.timer=new y(()=>this.tick(),e),this.timer.start()}get currentFrame(){return this.frames[this.indexCurrentFrame]}update(){this.timer.update()}tick(){this.indexCurrentFrame=(this.indexCurrentFrame+1)%this.frames.length}}const Y=class Y{constructor(t,e,i){this.renderProvider=o.getInstance(),this.animator=new Ot(t,150),this.opacity=Y.FOCUS_OPACITY,this._position=e.position.sum(a.Horizontal(Y.WIDTH*(i+.5)-this.width*.5))}get position(){return this._position}get width(){return this.animator.currentFrame.width}blur(){this.opacity=Y.BLUR_OPACITY}focus(){this.opacity=Y.FOCUS_OPACITY}update(){this.animator.update()}render(){this.renderProvider.setOpacity(this.opacity,()=>{this.renderProvider.renderizer.drawImage(this.animator.currentFrame,this._position.x,this._position.y)})}};Y.WIDTH=68,Y.HEIGHT=63,Y.ANIMATION_INTERVAL_RATIO=.5,Y.FOCUS_OPACITY=1,Y.BLUR_OPACITY=.5;let Lt=Y;const f=class f{};f.ENEMY_FIRE_RATIO=400,f.ENEMY_HORD_REFIRE_DELAY=300,f.ENEMY_HORD_START_FIRE_DELAY=1500,f.ENEMY_LASER_SPEED=12,f.ENEMY_MOVING_ANIMATION_INTERVAL=200,f.ENEMY_FIRE_SPRITE_FIXINESS=600,f.ENEMY_QUANTITY_BY_ROW_IN_HORD=14,f.ENEMY_COLLIDER_RADIUS=13,f.ENEMY_HORD_SPAWN_POSITION_X_BY_SCREEN=.05,f.ENEMY_HORD_SPAWN_POSITION_Y_BY_SCREEN=.07,f.ENEMY_HORD_HORIZONTAL_GAP_BY_SCREEN=.052,f.ENEMY_HORD_VERTICAL_GAP_BY_SCREEN=.06,f.ENEMY_HORD_SPEED=new a(3,1),f.ENEMY_HORD_ACCELERATION_X=.05,f.ENEMY_HORD_ACCELERATION_INTERVAL=250,f.ENEMY_HORD_MOVING_DOWN_INTERVAL=250;let S=f;class mt{constructor(t){this.points=t}static WeakEnemyScorePoints(){return new mt(u.WEAK_ENEMY_SCORE_POINTS)}static RegularEnemyScorePoints(){return new mt(u.REGULAR_ENEMY_SCORE_POINTS)}static StrongEnemyScorePoints(){return new mt(u.STRONG_ENEMY_SCORE_POINTS)}}class Wi{constructor(t){this._position=t}get position(){return this._position}getCenter(){return new a(this.position.x+this.width*.5,this.position.y+this.height*.5)}}class Vt extends Wi{constructor(t,e,i=1){super(t),this._sprite=e,this.renderProvider=o.getInstance(),this.scale=i}get sprite(){return this._sprite}get width(){return this._sprite.width*this.scale}get height(){return this._sprite.height*this.scale}}class Tt{constructor(){this.lasers=new Map,this.renderProvider=o.getInstance()}static getInstance(){return this.instance||(this.instance=new Tt),this.instance}get size(){return this.lasers.size}isOutOfBounds(t){const{y:e}=t.position;return e<-t.height||e>this.renderProvider.canvasSize.height}generate(t){this.lasers.set(t.id,t)}destroy(t){this.lasers.delete(t.id)}update(){this.forEachLaser(t=>{t.update(),this.isOutOfBounds(t)&&this.destroy(t)})}render(){this.forEachLaser(t=>t.render())}checkLaserCollision(t,e){for(const i of this.lasers.values())if(!(t!==i.tag||!i.collider.isCollidesWith(e)))return this.destroy(i),i;return null}checkCollisionBetweenLasers(t){const e=this.lasers.values();for(const i of e)for(const s of e)i.tag===s.tag||!i.collider.isCollidesWith(s.collider)||(this.destroy(i),this.destroy(s),t(i,s))}forEachLaser(t){this.lasers.forEach(t)}}var ct=(r=>(r[r.Up=-1]="Up",r[r.Down=1]="Down",r))(ct||{});class Qe{constructor(t,e,i=a.Zero){this.gameObject=t,this.radius=e,this.offset=i,this.renderizer=o.getInstance().renderizer}isCollidesWith(t){const e=this.gameObject.getCenter().sum(this.offset).diff(t.gameObject.getCenter()).getMagnitude();return t.radius+this.radius>=e}render(t="#00ff00aa"){this.renderizer.fillStyle=t,this.renderizer.beginPath();const e=this.gameObject.getCenter();this.renderizer.arc(e.x+this.offset.x,e.y+this.offset.y,this.radius,0,2*Math.PI),this.renderizer.fill()}}const Qt=class Qt{};Qt.LASER_SCALE=1,Qt.COLLIDER_RADIUS=13,Qt.COLLIDER_OFFSET_Y=10;let Ut=Qt;class ds extends Vt{constructor(t,e,i,s,n){super(n.copy(),s,Ut.LASER_SCALE),this.tag=t,this.speed=e,this.direction=i,this.id=crypto.randomUUID(),this.collider=this.createCollider(),this.centerByLaser()}centerByLaser(){this._position=this._position.diff(a.Horizontal(this.width/2))}createCollider(){return new Qe(this,Ut.COLLIDER_RADIUS,a.Vertical(this.direction*Ut.COLLIDER_OFFSET_Y))}update(){this.position.y+=this.speed*this.direction}render(){this.renderProvider.renderizer.drawImage(this._sprite,this.position.x,this.position.y,this.width,this.height)}}class Ps extends ds{constructor(t){super(u.ENEMY_LASER_TAG,S.ENEMY_LASER_SPEED,ct.Down,d.spriteManager.ENEMY_LASER,t)}}class As{constructor(t){this.enemy=t,this.laserController=Tt.getInstance(),this.canFire=!0,this.timerFireRatio=new y(()=>this.enableFire(),S.ENEMY_FIRE_RATIO)}fire(){this.canFire&&(this.createLaser(),this.canFire=!1,this.timerFireRatio.start())}update(){this.timerFireRatio.update()}get isFiring(){return!this.timerFireRatio.isStopped}enableFire(){this.canFire=!0,this.timerFireRatio.stop()}createLaser(){const{enemy:t}=this,e=t.position.sum(a.Horizontal(t.width/2));this.laserController.generate(new Ps(e))}}class _s{constructor(t){this._sprite=t,this.shown=!1,this.timer=new y(()=>{this.shown=!1,this.timer.stop()},S.ENEMY_FIRE_SPRITE_FIXINESS),this.timer.start()}update(){this.timer.update()}get isShown(){return this.shown}get sprite(){return this._sprite}show(){this.shown=!0,this.timer.start()}}class Ui extends Vt{constructor(t,e,i,s){super(t,e.moving[0],1),this.maxDamageCounter=i,this.scorePoints=s,this.id=crypto.randomUUID(),this.fireController=new As(this),this.movingAnimator=new Ot(e.moving,S.ENEMY_MOVING_ANIMATION_INTERVAL),this.fireSprite=new _s(e.fire),this.collider=new Qe(this,S.ENEMY_COLLIDER_RADIUS),this.damageCounter=0}update(){this.movingAnimator.update(),this.fireController.isFiring&&this.fireSprite.show(),this.fireController.update(),this.fireSprite.update()}render(){this.fillSprite(),this.renderProvider.renderizer.drawImage(this._sprite,this._position.x,this._position.y,this.width,this.height)}damage(){this.isDestroyed||this.damageCounter++}fire(){this.fireController.fire()}get isDestroyed(){return this.damageCounter>=this.maxDamageCounter}fillSprite(){this._sprite=this.fireSprite.isShown?this.fireSprite.sprite:this.movingAnimator.currentFrame}}class ys extends Ui{constructor(t){const e=d.spriteManager.REGULAR_ENEMY;super(t,e,u.REGULAR_ENEMY_DAMAGE_CAPACITY,mt.RegularEnemyScorePoints())}}class Ns extends Ui{constructor(t){const e=d.spriteManager.STRONG_ENEMY;super(t,e,u.STRONG_ENEMY_DAMAGE_CAPACITY,mt.StrongEnemyScorePoints())}}class Ls extends Ui{constructor(t){const e=d.spriteManager.WEAK_ENEMY;super(t,e,u.WEAK_ENEMY_DAMAGE_CAPACITY,mt.WeakEnemyScorePoints())}}function Gt(r){return Math.floor(Math.random()*r)}function Ms(r){const t=Gt(r);return Math.random()>.5?t:-t}class Rs{constructor(t){this.getEnemyList=t,this.refireTimer=new y(()=>{this.generateRandomFireEnemy()},S.ENEMY_HORD_REFIRE_DELAY),this.startFireTimer=new y(()=>{this.refireTimer.start(),this.startFireTimer.stop()},S.ENEMY_HORD_START_FIRE_DELAY),this.startFireTimer.start()}update(){this.startFireTimer.isStopped?this.refireTimer.update():this.startFireTimer.update()}generateRandomFireEnemy(){const t=this.getEnemyList();if(t.length===0&&!this.refireTimer.isStopped){this.refireTimer.stop();return}const e=Gt(t.length);t[e].fire()}}class vs{constructor(t){this.getEnemyList=t,this.direction=ct.Down,this.renderProvider=o.getInstance(),this.enemies=[],this.isMovingDown=!1,this.speed=S.ENEMY_HORD_SPEED.copy(),this.accelerationTimer=new y(()=>{this.speed=this.speed.sum(a.Horizontal(S.ENEMY_HORD_ACCELERATION_X))},S.ENEMY_HORD_ACCELERATION_INTERVAL),this.accelerationTimer.start(),this.moveDownTimer=new y(()=>this.isMovingDown=!1,S.ENEMY_MOVING_ANIMATION_INTERVAL)}update(){this.accelerationTimer.update(),this.moveDownTimer.update(),this.enemies=this.getEnemyList(),this.move(),this.checkChangeDirection()}move(){this.enemies.forEach(t=>{this.isMovingDown?t.position.y+=this.speed.y:t.position.x+=this.speed.x*this.direction})}changeDirection(t){this.direction=t,this.isMovingDown=!0,this.moveDownTimer.start()}checkChangeDirection(){this.isMovingDown||(this.enemies.some(t=>t.position.x<=0)?this.changeDirection(1):this.enemies.some(t=>t.position.x>=this.renderProvider.canvasSize.width-t.width)&&this.changeDirection(-1))}}class Cs{constructor(){this.enemies=this.createEnemies();const t=()=>this.getEnemyList();this.hordFireController=new Rs(t),this.hordMovementController=new vs(t)}update(){this.forEachEnemy(t=>t.update()),this.hordMovementController.update(),this.hordFireController.update()}render(){this.forEachEnemy(t=>t.render())}get noEnemies(){return this.enemies.size===0}destroy(t){this.enemies.delete(t.id)}forEachEnemy(t){this.enemies.forEach(t)}getEnemyList(){return Array.from(this.enemies.values())}createEnemies(){const t=new Map,e=o.getInstance(),i=e.getPositionByScreen(S.ENEMY_HORD_SPAWN_POSITION_X_BY_SCREEN,S.ENEMY_HORD_SPAWN_POSITION_Y_BY_SCREEN);let s=i.x,n=i.y;const h=e.getPositionByScreen(S.ENEMY_HORD_HORIZONTAL_GAP_BY_SCREEN,S.ENEMY_HORD_VERTICAL_GAP_BY_SCREEN);let l=0,p;for(l;l<S.ENEMY_QUANTITY_BY_ROW_IN_HORD;l++)p=new Ns(new a(s,n)),t.set(p.id,p),s+=h.x;for(n+=h.y,s=i.x,l;l<S.ENEMY_QUANTITY_BY_ROW_IN_HORD*2;l++)p=new ys(new a(s,n)),t.set(p.id,p),s+=h.x;for(n+=h.y,s=i.x,l;l<S.ENEMY_QUANTITY_BY_ROW_IN_HORD*3;l++)p=new Ls(new a(s,n)),t.set(p.id,p),s+=h.x;return t}}const qt=class qt{};qt.SHIELD_QUANTITY_IN_LINE=4,qt.COLLIDER_RADIUS=36,qt.SHIELD_LINE_SPAWN_POSITION_Y_BY_SCREEN=.62;let ce=qt;class xs extends Ot{constructor(t,e){super(t,e),this._isPlaying=!0}get isPlaying(){return this._isPlaying}update(){this._isPlaying&&super.update()}tick(){if(this.indexCurrentFrame<this.frames.length-1){this.indexCurrentFrame++;return}this.indexCurrentFrame=0,this._isPlaying=!1,this.clear&&this.clear()}onClear(t){this.clear=t}}const vt=class vt{constructor(t,e){this.id=crypto.randomUUID(),this.renderizer=o.getInstance().renderizer;const i=d.spriteManager.EXPLOSION;this.animator=new xs(i,vt.ANIMATION_INTERVAL);const s=e?Ms(vt.SPAWN_POSITION_OFFSET):0;this.position=t.diff(new a(i[0].width/2+s,i[0].height/2))}onClear(t){this.animator.onClear(()=>t(this.id))}update(){this.animator.update()}render(){this.renderizer.drawImage(this.animator.currentFrame,this.position.x,this.position.y)}};vt.SPAWN_POSITION_OFFSET=30,vt.ANIMATION_INTERVAL=50;let oi=vt;class V{constructor(){this.explosionEffects=new Map}static getInstance(){return V.instance||(V.instance=new V),V.instance}update(){this.forEachExplosionEffect(t=>t.update())}render(){this.forEachExplosionEffect(t=>t.render())}play(t,e){const i=new oi(t.getCenter(),e||!0);i.onClear(s=>this.explosionEffects.delete(s)),this.explosionEffects.set(i.id,i)}forEachExplosionEffect(t){this.explosionEffects.forEach(t)}}class Ds extends Vt{constructor(t){const e=d.spriteManager.SHIELD;super(t,e.noDamage,1.6),this.id=crypto.randomUUID(),this.sprites=[e.noDamage,e.damaged,e.veryDamaged],this.collider=new Qe(this,ce.COLLIDER_RADIUS),this.damageCounter=0,this.explosionEffectManager=V.getInstance()}update(){}render(){this.renderProvider.renderizer.drawImage(this._sprite,this.position.x,this.position.y,this.width,this.height)}damage(){if(this.isDestroyed){this.explosionEffectManager.play(this,!1);return}this.damageCounter++,this._sprite=this.sprites[this.spriteIndex]}smash(){this.damageCounter=u.SHIELD_DAMAGE_CAPACITY}get isDestroyed(){return this.damageCounter>=u.SHIELD_DAMAGE_CAPACITY}get spriteIndex(){return Math.floor(this.damageCounter*this.sprites.length/u.SHIELD_DAMAGE_CAPACITY)}}class Ki{constructor(){this.shields=this.createShields()}update(){this.forEachShield(t=>t.update())}render(){this.forEachShield(t=>t.render())}destroy(t){this.shields.delete(t.id)}forEachShield(t){this.shields.forEach(t)}static calculateSpaceBetweenShields(t,e,i){return(t-e*i)/(i+1)}createShields(){const t=new Map,e=ce.SHIELD_QUANTITY_IN_LINE;let i=0;const{canvasSize:s}=o.getInstance(),n=s.height*ce.SHIELD_LINE_SPAWN_POSITION_Y_BY_SCREEN;for(let h=0;h<e;h++){const l=new Ds(new a(i,n));i+=Ki.calculateSpaceBetweenShields(s.width,l.width,e),l.position.x=i,t.set(l.id,l),i+=l.width}return t}}class Fs{constructor(t){this.shieldLine=t,this.explosionEffectManager=V.getInstance(),this.laserController=Tt.getInstance()}update(){this.shieldLine.forEachShield(t=>{this.checkCollisionWithPlayerLaser(t),this.checkShieldDamage(t)})}checkCollisionWithPlayerLaser(t){const e=this.laserController.checkLaserCollision(u.PLAYER_LASER_TAG,t.collider);e&&this.explosionEffectManager.play(e)}checkShieldDamage(t){const e=this.laserController.checkLaserCollision(u.ENEMY_LASER_TAG,t.collider);e&&(this.explosionEffectManager.play(e),t.damage(),t.isDestroyed&&this.shieldLine.destroy(t))}}class Hs{constructor(t,e){this.enemyHord=t,this.gameManager=e,this.explosionEffectManager=V.getInstance(),this.laserController=Tt.getInstance()}update(){this.checkCollisionWithAllPlayerLasers()}checkCollisionWithAllPlayerLasers(){this.enemyHord.forEachEnemy(t=>{this.checkCollisionWithPlayerLaser(t)})}checkCollisionWithPlayerLaser(t){const e=this.laserController.checkLaserCollision(u.PLAYER_LASER_TAG,t.collider);e&&(this.damageEnemy(t,e),t.isDestroyed&&this.destroyEnemy(t))}damageEnemy(t,e){t.damage(),this.explosionEffectManager.play(e)}destroyEnemy(t){this.explosionEffectManager.play(t,!1),this.enemyHord.destroy(t),this.gameManager.incrementScore(t.scorePoints)}}class Bs{constructor(t,e){this.playerManager=t,this.gameManager=e,this.explosionEffectManager=V.getInstance(),this.laserController=Tt.getInstance()}update(){this.playerManager.forEachPlayer(t=>{this.checkPlayerDamage(t)}),this.laserController.checkCollisionBetweenLasers((t,e)=>{this.explosionEffectManager.play(t,!1),this.explosionEffectManager.play(e,!1)})}checkPlayerDamage(t){if(t.isInvincible)return;const e=this.laserController.checkLaserCollision(u.ENEMY_LASER_TAG,t.collider);e&&(this.explosionEffectManager.play(e),t.damage(),t.isDead&&this.playerManager.noPlayers&&this.gameManager.saveScore())}}class Zi extends Error{constructor(t){super(t)}static TrackIsNotSetted(){return new Zi("The track is not setted")}}class J{constructor(){}static getInstance(){return J.instance||(J.instance=new J),J.instance}change(t){var e;(e=this._currentTrack)==null||e.stop(),t.stop(),this._currentTrack=t}get currentTrack(){if(!this._currentTrack)throw Zi.TrackIsNotSetted();return this._currentTrack}get hasTrack(){return!!this._currentTrack}}var I=(r=>(r[r.FirePlayerOne=0]="FirePlayerOne",r[r.LeftPlayerOne=1]="LeftPlayerOne",r[r.RightPlayerOne=2]="RightPlayerOne",r[r.FirePlayerTwo=3]="FirePlayerTwo",r[r.LeftPlayerTwo=4]="LeftPlayerTwo",r[r.RightPlayerTwo=5]="RightPlayerTwo",r[r.Pause=6]="Pause",r[r.Enter=7]="Enter",r[r.Exit=8]="Exit",r))(I||{});class ks{constructor(t){this.map=t,this.keyset=new Set,window.addEventListener("keydown",e=>{this.checkIfMapContainsKey(e,i=>this.addKeyToSet(i))}),window.addEventListener("keyup",e=>{this.checkIfMapContainsKey(e,i=>this.removeKeyToSet(i))})}checkIfMapContainsKey(t,e){const i=t.key.toLowerCase();this.map.has(i)&&e(this.map.get(i))}addKeyToSet(t){this.keyset.add(t)}removeKeyToSet(t){this.keyset.delete(t)}hasPulsed(t){return this.keyset.has(t)}}var U=(r=>(r.A="a",r.D="d",r.W="w",r.ArrowLeft="arrowleft",r.ArrowRight="arrowright",r.ArrowUp="arrowup",r.Backspace="backspace",r.Enter="enter",r.Esc="escape",r))(U||{});class Q{constructor(){this.keymap=new Map([[U.A,I.LeftPlayerOne],[U.D,I.RightPlayerOne],[U.W,I.FirePlayerOne],[U.ArrowLeft,I.LeftPlayerTwo],[U.ArrowRight,I.RightPlayerTwo],[U.ArrowUp,I.FirePlayerTwo],[U.Enter,I.Enter],[U.Backspace,I.Pause],[U.Esc,I.Exit]]),this.gameControlManager=new ks(this.keymap)}static getInstance(){return Q.instance||(Q.instance=new Q),Q.instance}hasPulsed(t){return this.gameControlManager.hasPulsed(t)}}const Ct=class Ct{constructor(){this.renderProvider=o.getInstance(),this.sprite=d.spriteManager.PAUSE,this.timer=new y(()=>this.changeJumpDirection(),Ct.JUMP_DIRECTION_CHANGE_TIME),this.timer.start(),this.position=a.Zero,this.direction=1}update(){this.calculatePosition(),this.timer.update()}render(){const{renderizer:t}=this.renderProvider;t.drawImage(this.sprite,this.position.x,this.position.y)}changeJumpDirection(){this.direction=this.direction>0?ct.Up:ct.Down}calculatePosition(){const{renderProvider:t,direction:e}=this,i=t.halfScreenWidth-this.sprite.width/2,s=t.halfScreenHeight-this.sprite.height/2;this.position=new a(i,s+e*Ct.JUMP_OFFSET)}};Ct.JUMP_OFFSET=15,Ct.JUMP_DIRECTION_CHANGE_TIME=750;let ci=Ct;class Ys{constructor(){this.gameControlProvider=Q.getInstance(),this._isPaused=!1,this.pauseMessage=new ci,this.hasPulsedPauseButtonForFirstTime=!1,this.soundtrackManager=J.getInstance()}update(){this.checkPause(),this._isPaused&&this.pauseMessage.update()}render(){this._isPaused&&this.pauseMessage.render()}get isPaused(){return this._isPaused}togglePause(){this._isPaused=!this._isPaused;const t=this.soundtrackManager.currentTrack;this._isPaused?t.volumeController.setVolume(ae.Blurred):t.volumeController.setVolume(ae.Default)}hasPulsePauseButton(){return this.gameControlProvider.hasPulsed(I.Pause)}checkPause(){this.hasPulsePauseButton()&&this.hasPulsedPauseButtonForFirstTime?(this.togglePause(),this.hasPulsedPauseButtonForFirstTime=!1):!this.hasPulsePauseButton()&&!this.hasPulsedPauseButtonForFirstTime&&(this.hasPulsedPauseButtonForFirstTime=!0)}}class Xi{constructor(t){this._position=t}get position(){return this._position}}class ji extends Xi{constructor(t){super(t.position),this.textContent=t}render(){this.textContent.render()}get height(){return this.textContent.height}get width(){return this.textContent.width}}class Gs{constructor(t,e){this.visualElement=t,this.opacity=e,this.renderProvider=o.getInstance()}render(){this.renderProvider.setOpacity(this.opacity,()=>this.visualElement.render())}}class bs{constructor(t){this.initialPosition=t,this.offsetMemories=[]}addOffsetMemory(t){this.offsetMemories.push(t)}calculatePosition(){let t=this.initialPosition;return this.offsetMemories.forEach(e=>{t=t.sum(e())}),t}get isEmpty(){return this.offsetMemories.length===0}}const G=class G{constructor(t,e,i,s){this.content=t,this.color=e,this.fontSize=i,this.renderProvider=o.getInstance(),this.textPositionMemory=new bs(s.copy()),this._position=s,this._alignment=G.DEFAULT_ALIGNMENT,this._opacity=1,this.content.addChangeValueListener(()=>{this.textPositionMemory.isEmpty||(this._position=this.textPositionMemory.calculatePosition())})}static NewTextContentWithDefaultSize(t,e,i){return new G(t,e,G.DEFAULT_FONT_SIZE,i)}update(){this.content.onCheckChangeValue(this.content.getValue())}render(){const{renderizer:t}=this.renderProvider;t.font=this.getFont(this.fontSize),t.fillStyle=this.color,this.writeText()}get opacity(){return this._opacity}set opacity(t){if(t<0)throw new Error("Only numbers be greater or equal to 0");this._opacity=t}getTextLineLongest(t){return t.split(`
`).sort((i,s)=>s.length-i.length)[0]}getFont(t){return`${t}px ${u.DEFAULT_FONT}`}writeText(){const{renderizer:t}=this.renderProvider,{fontSize:e,position:i}=this,s=this.getTextLines(),n=e+G.LINE_HEIGHT,h=this.getTotalHeight(s,n);let l=i.y-h;this.renderProvider.setOpacity(this.opacity,()=>{s.forEach(p=>{t.textAlign=this._alignment,t.fillText(p,i.x,l+e*.5),l+=n})}),t.textAlign=G.DEFAULT_ALIGNMENT}getTextLines(){return this.content.getValue().split(`
`)}getTotalHeight(t,e){return e*t.length*.5-e*.5}getLineCount(){return this.getTextLines().length}get width(){const{content:t,fontSize:e}=this,{renderizer:i}=this.renderProvider,s=this.getTextLineLongest(t.getValue()),n=i.font;i.font=this.getFont(e);const h=i.measureText(s).width;return i.font=n,h}get height(){const t=this.getLineCount(),e=this.fontSize*t,i=G.LINE_HEIGHT*(t-1);return e+i}get position(){return this._position}set position(t){this._position=t}set alignment(t){this._alignment=t}addOffset(t){this._position=this._position.sum(t)}addOffsetAndRememberIt(t){this.addOffset(t()),this.textPositionMemory.addOffsetMemory(t)}};G.DEFAULT_FONT_SIZE=20,G.DEFAULT_ALIGNMENT="left",G.LINE_HEIGHT=8;let wt=G;class ls{constructor(){this.previousValue=""}addChangeValueListener(t){this.changeValueListener=t}onCheckChangeValue(t){t!==this.previousValue&&(this.previousValue&&this.changeValueListener&&this.changeValueListener(),this.previousValue=t)}}const zs="modulepreload",Vs=function(r){return"/invasores_p_web_sandbox/"+r},es={},Ee=function(t,e,i){if(!e||e.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(e.map(n=>{if(n=Vs(n),n in es)return;es[n]=!0;const h=n.endsWith(".css"),l=h?'[rel="stylesheet"]':"";if(!!i)for(let St=s.length-1;St>=0;St--){const ge=s[St];if(ge.href===n&&(!h||ge.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${l}`))return;const P=document.createElement("link");if(P.rel=h?"stylesheet":zs,h||(P.as="script",P.crossOrigin=""),P.href=n,document.head.appendChild(P),h)return new Promise((St,ge)=>{P.addEventListener("load",St),P.addEventListener("error",()=>ge(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t()).catch(n=>{const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=n,window.dispatchEvent(h),!h.defaultPrevented)throw n})},Ws=(r,t)=>{const e=r[t];return e?typeof e=="function"?e():Promise.resolve(e):new Promise((i,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})};class ht{constructor(t){this.dictionary=t,this.lang=u.DEFAULT_LANG}static getInstance(){return ht.instance}static async init(){ht.instance||(ht.instance=new ht(await ht.Dictionary()))}static async Dictionary(){const t=new Map;for(const e of Object.values(Vi))try{const i=new Map,s=(await Ws(Object.assign({"../lang/en.json":()=>Ee(()=>import("./en-0b09469e.js"),[]),"../lang/es.json":()=>Ee(()=>import("./es-89015693.js"),[]),"../lang/fr.json":()=>Ee(()=>import("./fr-5bbcc977.js"),[]),"../lang/pt.json":()=>Ee(()=>import("./pt-c0b29212.js"),[])}),`../lang/${e}.json`)).default;Object.entries(s).forEach(([n,h])=>{i.set(n,h)}),t.set(e,i)}catch{continue}return t}change(t){this.lang=t}getText(t){const i=this.dictionary.get(this.lang).get(t);if(!i)throw new Error(`Text with id ${t} not exists`);return i}}class Et extends ls{constructor(t){super(),this.id=t,this.translationManager=ht.getInstance()}getValue(){return this.translationManager.getText(this.id)}}const ke=class ke{constructor(t){const e=new wt(new Et("game_scene.text.game_exit"),c.Light,ke.GAME_EXIT_FONT_SIZE,t.copy());e.addOffset(a.Horizontal(-e.width*.5)),this.transparentEffect=new Gs(new ji(e),.5)}render(){this.transparentEffect.render()}};ke.GAME_EXIT_FONT_SIZE=20;let di=ke;class x extends cs{constructor(){super()}static getInstance(){return x.instance||(x.instance=new x),x.instance}}var li=(r=>(r.Wav="wav",r.Mp3="mp3",r))(li||{});class us{static get Menu(){return he.Create("menu",li.Wav)}static get Game(){return he.Create("Sad Statue - System Of A Down",li.Mp3)}}const Ye=class Ye extends Wi{constructor(t,e){super(t.copy()),this.renderProvider=o.getInstance(),this.speed=e,this.scale=Ye.SCALE,this.size=Gt(this.scale)}update(){this.position.y+=this.speed}render(){const{renderizer:t}=this.renderProvider;t.fillStyle=c.Light,t.fillRect(this.position.x,this.position.y,this.size,this.size)}startAgain(t){const{width:e}=this.renderProvider.canvasSize;t.position.x=Gt(e),t.position.y=0}get width(){return this.size}get height(){return this.size}};Ye.SCALE=9;let ui=Ye;class Us{constructor(t,e){this.speed=e,this.stars=Array(t),this.renderProvider=o.getInstance(),this.speed=e,this.init()}isOutOfBounds(t){const{height:e}=this.renderProvider.canvasSize;return t.position.y>e}init(){for(let t=0;t<this.stars.length;t++){const e=this.createPosition(this.renderProvider.canvasSize);this.stars[t]=new ui(e,this.speed)}}createPosition({width:t,height:e}){const i=Gt(t),s=Gt(e);return new a(i,s)}followPath(){this.stars.forEach(t=>{t.update(),this.isOutOfBounds(t)&&t.startAgain(t)})}render(){this.stars.forEach(t=>t.render())}}class gs{constructor(t){this.color=t,this.renderProvider=o.getInstance()}render(){const{renderizer:t,canvasSize:e}=this.renderProvider;t.fillStyle=this.color,t.fillRect(0,0,e.width,e.height)}}const xt=class xt extends Wi{constructor(t){super(a.Zero),this.renderProvider=o.getInstance(),this.starController=new Us(xt.QUANTITY_STARS,t),this.background=new gs(xt.SPACE_BACKGROUND_COLOR)}update(){this.starController.followPath()}render(){this.background.render(),this.starController.render()}get width(){return this.renderProvider.canvasSize.width}get height(){return this.renderProvider.canvasSize.height}};xt.QUANTITY_STARS=100,xt.SPACE_BACKGROUND_COLOR=c.Dark;let me=xt;const A=class A extends os{constructor(t,e,i,s,n){super(t,e,new g(i,c.Dark,e.height*n,t.copy())),this.sprite=s}static NewLargeSize(){return new D(A.CONTROL_LARGE_SIZE,A.CONTROL_SQUARE_SIZE)}static NewSmallSize(){return new D(A.CONTROL_SQUARE_SIZE,A.CONTROL_SQUARE_SIZE)}static Large(t,e){const i=d.spriteManager.KEY_SPRITES.large;return new A(t,A.NewLargeSize(),e,i,.3)}static Small(t,e){const i=d.spriteManager.KEY_SPRITES.small;return new A(t,A.NewSmallSize(),e,i,.5)}static SmallWithWord(t,e){const i=d.spriteManager.KEY_SPRITES.small;return new A(t,A.NewSmallSize(),e,i,.3)}render(){const{renderizer:t}=this.renderProvider;t.drawImage(this.sprite,this.position.x,this.position.y,this.size.width,this.size.height),this.textContent.render()}};A.CONTROL_SQUARE_SIZE=75,A.CONTROL_LARGE_SIZE=200;let ot=A;class z extends wt{constructor(t,e){super(t,c.Highlighted,g.DEFAULT_FONT_SIZE,e)}static PlayerCaption(t,e){return new z(t,e)}static Fire(t){return z.PlayerCaption(new Et("controls_scene.text.fire"),t)}static Move(t){return z.PlayerCaption(new Et("controls_scene.text.move"),t)}static Navigation(t,e){const i=new z(t,new a(e.position.x,e.bottom));return i.addOffsetAndRememberIt(()=>a.Horizontal(e.width*.5-i.width*.5)),i}static Pause(t){return z.Navigation(new Et("controls_scene.text.pause"),t)}static Exit(t){return z.Navigation(new Et("controls_scene.text.exit"),t)}}const dt=class dt{constructor(t,e){this.caption=t,this.key=e,t.addOffsetAndRememberIt(()=>a.Vertical(dt.GAP))}static PauseKey(){const t=o.getInstance(),e=ot.Large(t.getPositionByScreen(.4,.7),"backspace");return new dt(z.Pause(e),e)}static ExitKey(t){const e=ot.SmallWithWord(new a(t.key.position.x+t.key.width+dt.GAP_BETWEEN_CONTROL_KEYS,t.key.position.y),"esc");return new dt(z.Exit(e),e)}update(){this.caption.update()}render(){this.key.render(),this.caption.render()}};dt.GAP=30,dt.GAP_BETWEEN_CONTROL_KEYS=50;let Oe=dt;const C=class C{constructor(t,e,i){this.title=new g(t,c.Highlighted,40,i),this.title.addOffset(a.Horizontal(-this.title.width*.5)),this.fireKey=ot.Small(this.calculateFireKeyPosition(),e.fire);const s=this.fireKey.bottom+C.MOVING_KEY_GAP;this.leftKey=ot.Small(new a(this.fireKey.x-this.fireKey.width-C.MOVING_KEY_GAP,s),e.left),this.rightKey=ot.Small(new a(this.fireKey.right+C.MOVING_KEY_GAP,s),e.right),this.centerKey=ot.Small(new a(this.fireKey.x,s),"")}get width(){return this.rightKey.right-this.leftKey.x}get x(){return this.leftKey.x}get right(){return this.rightKey.right}get fireKeyCenterY(){return this.fireKey.y+this.fireKey.width*.5}get centerKeyCenterY(){return this.centerKey.y+this.centerKey.width*.5}get y(){return this.title.position.y}static PlayerOneGroup(t){return new C("J1",{right:"d",left:"a",fire:"w"},t)}static PlayerTwoGroup(t){return new C("J2",{right:"→",left:"←",fire:"↑"},new a(t.right+t.width*.5+C.GAP_BETWEEN_GROUPS,t.y))}calculateFireKeyPosition(){const t=this.title.width*.5-ot.CONTROL_SQUARE_SIZE*.5,e=this.title.height+C.TITLE_TO_PIVOT_KEY_GAP;return new a(this.title.position.x+t,this.title.position.y+e)}render(){this.fireKey.render(),this.leftKey.render(),this.rightKey.render(),this.centerKey.render(),this.title.render()}};C.MOVING_KEY_GAP=15,C.TITLE_TO_PIVOT_KEY_GAP=15,C.GAP_BETWEEN_GROUPS=70;let we=C;const te=class te{constructor(){const t=o.getInstance(),e=we.PlayerOneGroup(t.getPositionByScreen(.44,.22));this.playerControlKeyGroupList=[e,we.PlayerTwoGroup(e)],this.controlCaptions=te.ControlCaptions(e)}static ControlCaptions(t){const e=[z.Fire(new a(t.x,t.fireKeyCenterY)),z.Move(new a(t.x,t.centerKeyCenterY))],i=Math.max(...e.map(s=>s.width));return e.forEach(s=>{s.addOffset(a.Horizontal(-i-te.GAP))}),e}render(){this.playerControlKeyGroupList.forEach(t=>t.render()),this.controlCaptions.forEach(t=>t.render())}};te.GAP=70;let gi=te;class Ks{constructor(){const t=Oe.PauseKey();this.navigationControlsKey=[t,Oe.ExitKey(t)],this.playerControlKeys=new gi,this.backToMainMenuButton=R.BackToMainMenuButton()}update(){this.backToMainMenuButton.update(),this.navigationControlsKey.forEach(t=>t.update())}render(){this.backToMainMenuButton.render(),this.navigationControlsKey.forEach(t=>t.render()),this.playerControlKeys.render()}}const Ge=class Ge extends W{constructor(t,e){super(e.getNewButtonPosition(new a(t.x,t.bottom)),Ge.CONTENT,v.Default,F.Medium,()=>{this.removeClickListener(),this.action()}),this.gameMenuSceneManager=w.getInstance()}action(){this.gameMenuSceneManager.changeScene(new Ks)}};Ge.CONTENT="CONTROLES";let Ei=Ge;const et=class et{};et.CONTRIBUITOR_VERTICAL_SCROLLING_SPEED=6,et.OVERLAY_EXPANSION_SPEED=35,et.SHIP_SPEED_TARGET=2.5,et.SHIP_TWO_SPEED_TARGET=10,et.SHIP_TWO_DECELERATION=.065,et.SHIP_ONE_MOVEMENT_DATA=Object.freeze({speed:2.5,speedTarget:2.5,deceleration:0}),et.SHIP_TWO_MOVEMENT_DATA=Object.freeze({speed:10,speedTarget:2.5,deceleration:.065});let Pt=et;class $i{constructor(t,e){this._expanded=!1,this.renderProvider=o.getInstance(),this.position=new a(this.renderProvider.halfScreenWidth,this.renderProvider.getMeasureByScreenHeight(t)),this.size=new D(0,this.renderProvider.getMeasureByScreenHeight(e))}get y(){return this.position.y}get centerY(){return this.y+this.size.height*.5}get expanded(){return this._expanded}expand(){const t=Pt.OVERLAY_EXPANSION_SPEED;if(this.position.x===0&&this.size.width===this.renderProvider.canvasSize.width){this._expanded=!0;return}if(this.position.x-t<=0&&this.size.width+t*2>=this.renderProvider.canvasSize.width){this.position.x=0,this.size.width=this.renderProvider.canvasSize.width;return}this.position.x-=t,this.size.width+=t*2}render(){const{renderizer:t}=this.renderProvider,{position:e,size:i}=this;t.fillStyle=c.Overlay,t.fillRect(e.x,e.y,i.width,i.height)}}const N=class N{};N.MOVEMENT_SPEED=10,N.FIRE_RATIO=170,N.LASER_SPEED=14,N.IDLE_ANIMATION_INTERVAL=350,N.MOVING_ANIMATION_INTERVAL=140,N.COLLIDER_RADIUS=25,N.PLAYER_SPAWN_PIVOT_POSITION_X_IN_SCREEN=.5,N.PLAYER_SPAWN_DISTANCE_TO_PIVOT_POSITION_X_IN_SCREEN=.1,N.PLAYER_SPAWN_POSITION_Y_IN_SCREEN=.75,N.INVINCIBILITY_OSCILLATIONS=3,N.INVINCIBILITY_OSCILLATION_INTERVAL=200;let E=N;const Dt=class Dt{constructor(t,e,i){this.allSprites=t,this._position=e,this._hasPassedScreen=!1,this.sprites=t.idle,this.speed=i.speed,this.renderProvider=o.getInstance(),this.animator=new Ot(this.sprites,E.MOVING_ANIMATION_INTERVAL*Dt.ANIMATION_INTERVAL_RATIO),this.speedTarget=i.speedTarget,this.deceleration=i.deceleration,this.renderProvider=o.getInstance()}static OneShip(t,e){return new Dt(d.spriteManager.SHIP_ONE,t,e)}static TwoShip(t,e){return new Dt(d.spriteManager.SHIP_TWO,t,e)}get hasPassedScreen(){return this._hasPassedScreen}get bottom(){return this._position.y+this.height}get height(){return this.sprites[0].height}decelerate(){this.speed=Math.max(this.speedTarget,this.speed-this.deceleration)}checkSpritesByState(){this.sprites=this.speed<=0?this.allSprites.idle:this.allSprites.moving}forward(){if(this._position.y<=this.renderProvider.getMeasureByScreenHeight(-.1)){this._hasPassedScreen=!0;return}this.decelerate(),this.checkSpritesByState(),this._position.y-=this.speed,this.animator.update()}render(){const t=this.animator.currentFrame;this.renderProvider.renderizer.drawImage(t,this._position.x,this._position.y,t.width,t.height)}};Dt.ANIMATION_INTERVAL_RATIO=.72;let bt=Dt;class Zs{constructor(){const t=o.getInstance();this.shipOne=bt.OneShip(new a(t.getMeasureByScreenWidth(.28),t.canvasSize.height),Pt.SHIP_ONE_MOVEMENT_DATA),this.shipTwo=bt.TwoShip(t.getPositionByScreen(.72,1.2),Pt.SHIP_TWO_MOVEMENT_DATA)}get hasPassedScreen(){return[this.shipOne,this.shipTwo].every(t=>t.hasPassedScreen)}shipTwoCanNowMoveForward(){const t=o.getInstance();return this.shipOne.bottom<=t.getMeasureByScreenHeight(.6)}forward(){this.shipOne.forward(),this.shipTwoCanNowMoveForward()&&this.shipTwo.forward()}render(){this.shipOne.render(),this.shipTwo.render()}}const Xs=[{workAreaId:"credit_scene.text.ui_design",contribuitors:[{name:"Manuel Rivera",social:"github@LeunknownR"},{name:"Mario Roy",social:"instagram@hicor13"}]},{workAreaId:"credit_scene.text.game_design",contribuitors:[{name:"Manuel Rivera",social:"github@LeunknownR"}]},{workAreaId:"credit_scene.text.programming",contribuitors:[{name:"Manuel Rivera",social:"github@LeunknownR"},{name:"Ausubel Velasquez",social:"github@avelasquez"}]},{workAreaId:"credit_scene.text.soundtrack",contribuitors:[{name:"Josué Martinez",social:"instagram@gcore.2157"}]}],ee=class ee extends g{constructor(t,e){super(ee.getContribuitorFullname(t),c.Light,ee.CONTRIBUITOR_FONT_SIZE,e),this.addOffset(a.Horizontal(-this.width*.5))}static getContribuitorFullname(t){return`${t.name} (${t.social})`}};ee.CONTRIBUITOR_FONT_SIZE=16;let pi=ee;const lt=class lt{constructor(t,e,i){this.renderProvider=o.getInstance(),this.title=new g(t.getValue(),c.Highlighted,lt.TITLE_FONT_SIZE,new a(this.renderProvider.getMeasureByScreenWidth(.5),i)),this.title.addOffset(new a(-this.title.width*.5,this.title.height*.5)),this.contribuitors=this.toContribuitorTextContent(e,this.title)}toContribuitorTextContent(t,e){const i=[];let s=new a(this.renderProvider.getMeasureByScreenWidth(.5),e.position.y+e.height+lt.TITLE_MARGIN_BOTTOM);return t.forEach(n=>{const h=new pi(n,s.copy());i.push(h),s=s.sum(a.Vertical(h.height+lt.GAP_BETWEEN_CONTRIBUITORS))}),i}get y(){return this.title.position.y}get bottom(){const t=this.contribuitors[this.contribuitors.length-1];return t.position.y+t.height}addOffset(t){this.title.addOffset(t),this.contribuitors.forEach(e=>{e.addOffset(t)})}render(){this.title.render(),this.contribuitors.forEach(t=>t.render())}};lt.TITLE_MARGIN_BOTTOM=20,lt.GAP_BETWEEN_CONTRIBUITORS=15,lt.TITLE_FONT_SIZE=20;let Ti=lt;const ie=class ie{constructor(t){this.overlayBackground=t,this._scrollingHasFinished=!1,this.renderProvider=o.getInstance(),this.creditWorkAreas=ie.WorkAreas(this.renderProvider),this.verticalScrollLimit=this.calculateVerticalScrollLimit()}calculateVerticalScrollLimit(){const e=this.creditWorkAreas[this.creditWorkAreas.length-1].bottom-this.renderProvider.canvas.height;return this.overlayBackground.centerY-e*.5}static WorkAreas(t){const e=[];let i=t.canvasSize.height;return Xs.forEach(({workAreaId:s,contribuitors:n},h,{length:l})=>{const p=new Ti(new Et(s),n,i);e.push(p),i=p.bottom,h===l-1||(i+=ie.GAP_BETWEEN_WORK_AREAS)}),e}scrollVertically(t){this.creditWorkAreas.forEach(e=>{e.addOffset(a.Vertical(-t))})}get scrollingHasFinished(){return this._scrollingHasFinished}scrollUp(){const t=this.creditWorkAreas[0].y;if(t===this.verticalScrollLimit){this._scrollingHasFinished=!0;return}const i=t-Pt.CONTRIBUITOR_VERTICAL_SCROLLING_SPEED<=this.verticalScrollLimit?t-this.verticalScrollLimit:Pt.CONTRIBUITOR_VERTICAL_SCROLLING_SPEED;this.scrollVertically(i)}forEachWorkArea(t){this.creditWorkAreas.forEach(t)}render(){this.forEachWorkArea(t=>t.render()),this.renderProvider.renderizer.fillStyle="#f00"}};ie.GAP_BETWEEN_WORK_AREAS=25;let Si=ie;class js{constructor(){this.overlayBackground=new $i(.2,.72),this.creditWorkAreaGroup=new Si(this.overlayBackground),this.ships=new Zs}update(){if(!this.ships.hasPassedScreen){if(this.overlayBackground.expanded){this.ships.forward();return}if(this.creditWorkAreaGroup.scrollingHasFinished){this.overlayBackground.expand();return}this.creditWorkAreaGroup.scrollUp()}}render(){this.ships.render(),this.overlayBackground.render(),this.creditWorkAreaGroup.render()}}class $s{constructor(){this.backToMainMenuButton=R.BackToMainMenuButton(),this.creditContribuitorsGroup=new js}update(){this.backToMainMenuButton.update(),this.creditContribuitorsGroup.update()}render(){this.backToMainMenuButton.render(),this.creditContribuitorsGroup.render()}}const be=class be extends W{constructor(t,e){super(e.getNewButtonPosition(new a(t.x,t.bottom)),be.CONTENT,v.Outstanding,F.Medium,()=>{this.removeClickListener(),this.action()}),this.gameMenuSceneManager=w.getInstance()}action(){this.gameMenuSceneManager.changeScene(new $s)}};be.CONTENT="CRÉDITOS";let Ii=be;const ze=class ze extends W{constructor(t,e){const i=o.getInstance(),s=F.Medium,n=i.halfScreenWidth-s.value.width*.5;super(e.getNewButtonPosition(new a(n,t.bottom),2.2),ze.CONTENT,v.Default,s,()=>{this.removeClickListener(),this.action()}),this.gameMenuSceneManager=w.getInstance()}action(){this.gameMenuSceneManager.changeScene(new fs)}};ze.CONTENT="JUGAR";let fi=ze;const Ft=class Ft{constructor(t){this.scoreRepository=t}existScoreRecords(){const t=this.scoreRepository.getLatestScores(),e=this.scoreRepository.getTopScores();return t.length>0&&e.length>0}getHighScore(){return this.scoreRepository.getHighScore().value}saveScore(t){this.scoreRepository.saveScoreRecord(t),this.scoreRepository.replaceSomeTopScoreIfNecessary(t)}getTopScores(){return this.scoreRepository.getTopScores()}getLatestScores(){return this.scoreRepository.getLatestScores()}static getScoreFormat(t){return t.toString().padStart(Ft.MAX_FIGURE_SCORE,Ft.DEFAULT_DIGIT)}};Ft.MAX_FIGURE_SCORE=7,Ft.DEFAULT_DIGIT="0";let Pe=Ft;class Js extends Error{constructor(t){super(t),this.name="ScoreError"}}class mi{constructor(t){const e=parseInt(t);if(!Number.isInteger(e))throw new Js("Invalid score points");this.value=e}}class is extends Error{constructor(t){super(t),this.name="GameRespositoryError"}}class ss{constructor(t){this.key=t}get(){const t=localStorage.getItem(this.key);return t?JSON.parse(t):null}set(t){localStorage.setItem(this.key,JSON.stringify(t))}}function Qs(r){const t=r.getDate().toString().padStart(2,"0"),e=r.getMonth().toString().padStart(2,"0"),i=r.getFullYear().toString();return`${t}/${e}/${i}`}function qs(r){const t=r.getHours().toString().padStart(2,"0"),e=r.getMinutes().toString().padStart(2,"0");return`${t}:${e}`}const K=class K{constructor(){this.latestScoreEntity=new ss(K.LATEST_SCORE_LOCAL_STORAGE_KEY),this.topScoreEntity=new ss(K.TOP_SCORE_LOCAL_STORAGE_KEY)}getHighScore(){const t=this.topScoreEntity.get();return!t||t.length===0?new mi(0):new mi(t[0].points)}static getInstance(){return K.instance||(K.instance=new K),K.instance}getTopScores(){const t=this.topScoreEntity.get();if(!t||t.length===0)return[];const e=t.map(i=>this.getScoreRecord(i));return e.length=u.TOP_SCORE_COUNT,e}getLatestScores(){const t=this.latestScoreEntity.get();if(!t||t.length===0)return[];const e=t.map(i=>this.getScoreRecord(i));return e.length=u.LATEST_SCORE_COUNT,e}getScoreRecord(t){const e=new Date(t.dateTime);return{points:t.points,date:Qs(e),time:qs(e)}}replaceScore(t,e){for(const i in t){const{points:s}=t[i];if(e.points>s)return t[i]=e,!0}return!1}replaceSomeTopScoreIfNecessary(t){try{const e=this.topScoreEntity.get(),i={points:t.value,dateTime:new Date().toJSON()};if(!e||e.length===0){this.topScoreEntity.set([i]);return}if(e.sort((n,h)=>h.points-n.points),this.replaceScore(e,i)||e.length>=u.TOP_SCORE_COUNT){this.topScoreEntity.set(e);return}e.push(i),this.topScoreEntity.set(e)}catch{throw new is("Couldn't save high score record")}}saveScoreRecord(t){try{const e=this.latestScoreEntity.get()||[];e.unshift({points:t.value,dateTime:new Date().toJSON()}),e.length>u.LATEST_SCORE_COUNT&&(e.length=u.LATEST_SCORE_COUNT),this.latestScoreEntity.set(e)}catch{throw new is("Couldn't save score record")}}};K.LATEST_SCORE_LOCAL_STORAGE_KEY="latestScoreHistory",K.TOP_SCORE_LOCAL_STORAGE_KEY="topScoreHistory";let Oi=K;class Ji{static getScoreService(){return new Pe(Oi.getInstance())}}const it=class it{constructor(t,e,i,s){this.startPosition=e,this.tableWidth=s,this.caption=new g(t,c.Light,it.CAPTION_FONT_SIZE,e),this.headers=this.toHeaders(i,this.caption),this.adjustPosition()}render(){this.headers.forEach(t=>t.render()),this.caption.render()}adjustPosition(){this.adjustCaptionPosition()}toHeaders(t,e){const i=this.getHeaderWidth(t.length),s=(this.tableWidth-i*t.length)/t.length+1;let n=this.startPosition.x;const h=this.startPosition.y+e.height+it.HEAD_VERTICAL_GAP,l=[];return t.forEach(p=>{n+=s;const P=new g(p,c.Light,it.HEADER_FONT_SIZE,new a(n,h));n+=i,l.push(P)}),l}getHeaderWidth(t){return this.tableWidth/t*.8}adjustCaptionPosition(){this.caption.addOffset(a.Horizontal(this.tableWidth*.5-this.caption.width*.5))}getCell(t){return this.headers[t]}get y(){return this.caption.position.y}get bottom(){return this.caption.position.y+this.height}get height(){const{caption:t,headers:e}=this,i=Math.max(...e.map(({height:s})=>s));return t.height+it.HEAD_VERTICAL_GAP+i}addCaptionOffset(t){this.caption.addOffset(t)}addOffset(t){this.caption.addOffset(t),this.headers.forEach(e=>e.addOffset(t))}};it.CAPTION_FONT_SIZE=18,it.HEADER_FONT_SIZE=16,it.HEAD_VERTICAL_GAP=10;let wi=it;const Ve=class Ve{constructor(t,e,i,s,n,h){this.records=i,this.gap=h,this.head=new wi(t,s,e,n)}render(){this.head.render(),this.records.forEach(t=>t.render())}get height(){const t=this.records.reduce((e,{height:i})=>e+i+this.gap,0);return this.head.height+t}get bottom(){return this.head.y+this.height}addOffset(t){this.head.addOffset(t),this.records.forEach(e=>e.addOffset(t))}};Ve.FONT_SIZE_CELL=16,Ve.INDEX_RECORD_HORIZONTAL_GAP=20;let At=Ve;class rs extends g{constructor(t){super(t,c.LatestScore,At.FONT_SIZE_CELL,a.Zero)}get right(){return this.position.x+this.width}}class Es{constructor(t,e){this.cells=[t,...e]}get height(){return Math.max(...this.cells.map(({height:t})=>t))}addOffset(t){this.cells.forEach(e=>e.addOffset(t))}getCell(t){return this.cells[t]}get indexCell(){return this.cells[0]}render(){this.cells.forEach(t=>t.render())}}class tr extends g{constructor(t,e){super(`${t}.`,c.LatestScore,At.FONT_SIZE_CELL,e)}get right(){return this.position.x+this.width}}class er extends Es{constructor(t,{points:e,date:i}){super(new tr(t,a.Zero),[new rs(e),new rs(i)])}}class $ extends g{constructor(t,e){super(t,e,At.FONT_SIZE_CELL,a.Zero)}static First(t){return new $(t,c.FirstScore)}static Second(t){return new $(t,c.SecondScore)}static Third(t){return new $(t,c.ThirdScore)}get right(){return this.position.x+this.width}}class ir{constructor(t,e){this.sprite=t,this._position=e,this.renderProvider=o.getInstance()}get width(){return this.sprite.width}get height(){return this.sprite.height}get right(){return this.position.x+this.sprite.width}get position(){return this._position.sum(a.Vertical(this.height*.42))}addOffset(t){this._position=this._position.sum(t)}render(){this.renderProvider.renderizer.drawImage(this.sprite,this._position.x,this._position.y,this.width,this.height)}}const st=class st extends Es{constructor(t,e,i){const s=new a(st.INDEX_HORIZONTAL_OFFSET,st.INDEX_VERTICAL_OFFSET);super(new ir(t,s),[e,i])}static First({points:t,date:e}){return new st(d.spriteManager.SCORE_MEDALS.first,$.First(t),$.First(e))}static Second({points:t,date:e}){return new st(d.spriteManager.SCORE_MEDALS.second,$.Second(t),$.Second(e))}static Third({points:t,date:e}){return new st(d.spriteManager.SCORE_MEDALS.third,$.Third(t),$.Third(e))}};st.INDEX_HORIZONTAL_OFFSET=-4,st.INDEX_VERTICAL_OFFSET=-10;let Kt=st;const sr={1:r=>Kt.First(r),2:r=>Kt.Second(r),3:r=>Kt.Third(r)},m=class m extends At{constructor(t,e,i,s){super(t,m.SCORE_TABLE_HEADERS,e,i.sum(a.Horizontal(-m.TABLE_WIDTH*.5)),m.TABLE_WIDTH,s),this.adjustRecords(),this.adjustHeaders()}static TopScoreTable(t,e){return new m("MEJORES PUNTAJES",t,e,m.TOP_SCORE_RECORD_VERTICAL_GAP)}static LatestScoreTable(t,e){return new m("ÚLTIMOS PUNTAJES",t,e,m.LATEST_SCORE_RECORD_VERTICAL_GAP)}adjustHeaders(){const t=this.head.getCell(0),e=this.head.getCell(1),i=this.records[0],s=i.getCell(1),n=i.getCell(2);this.head.addCaptionOffset(a.Horizontal(m.CAPTION_OFFSET_POSITION)),t.addOffset(a.Horizontal(i.indexCell.width+m.INDEX_RECORD_HORIZONTAL_GAP+s.width*.5-t.width*.5)),e.addOffset(a.Horizontal(n.width*.5-e.width*.5))}adjustRecords(){let t=this.head.bottom;const e=this.head.getCell(0),i=this.head.getCell(1);this.records.forEach(s=>{s===this.records[0]?t+=this.gap:t+=s.height+this.gap,s.addOffset(a.Vertical(t));const n=s.getCell(1),h=s.getCell(2);s.indexCell.addOffset(a.Horizontal(e.position.x)),n.addOffset(a.Horizontal(s.indexCell.right+At.INDEX_RECORD_HORIZONTAL_GAP)),h.addOffset(a.Horizontal(i.position.x))})}};m.TABLE_WIDTH=500,m.CAPTION_OFFSET_POSITION=m.TABLE_WIDTH*.02,m.SCORE_TABLE_HEADERS=["Obtuvo","¿Cuándo?"],m.TOP_SCORE_RECORD_VERTICAL_GAP=14,m.LATEST_SCORE_RECORD_VERTICAL_GAP=18;let Ae=m;const se=class se{constructor(t){this.scoreService=Ji.getScoreService();const i=o.getInstance().halfScreenWidth;this.topScoreTable=Ae.TopScoreTable(this.getTopScores(),new a(i,t.centerY)),this.latestScoreTable=Ae.LatestScoreTable(this.getLatestScores(),new a(i,se.GAP+this.topScoreTable.bottom));const s=a.Vertical(-(this.topScoreTable.height+se.GAP+this.latestScoreTable.height)*.5);this.topScoreTable.addOffset(s),this.latestScoreTable.addOffset(s)}getTopScores(){return this.scoreService.getTopScores().map(e=>this.formatScore(e)).map((e,i)=>sr[i+1](e))}getLatestScores(){return this.scoreService.getLatestScores().map(e=>this.formatScore(e)).map((e,i)=>new er(i+1,e))}formatScore(t){return{points:`${Pe.getScoreFormat(t.points)} pts`,date:`${t.date} | ${t.time}`}}render(){this.topScoreTable.render(),this.latestScoreTable.render()}};se.GAP=20;let Pi=se;const We=class We{constructor(){this.backToMainMenuButton=R.BackToMainMenuButton(),this.overlayBackground=new $i(.17,We.OVERLAY_BACKGROUND_HEIGHT),this.scoreTableGroup=new Pi(this.overlayBackground)}update(){this.backToMainMenuButton.update(),this.overlayBackground.expand()}render(){this.backToMainMenuButton.render(),this.overlayBackground.render(),this.scoreTableGroup.render()}};We.OVERLAY_BACKGROUND_HEIGHT=.7;let Ai=We;const Ue=class Ue extends W{constructor(t,e){super(e.getNewButtonPosition(new a(t.x,t.bottom)),Ue.CONTENT,v.Default,F.Medium,()=>{this.removeClickListener(),this.action()}),this.scoreService=Ji.getScoreService(),this.gameMenuSceneManager=w.getInstance()}action(){const t=this.scoreService.existScoreRecords()?new Ai:new Me;this.gameMenuSceneManager.changeScene(t)}};Ue.CONTENT="PUNTAJES";let _i=Ue;const Ke=class Ke{constructor(t){const e=new fi(t,this),i=new _i(e,this),s=new Ei(i,this),n=new Ii(s,this);this.buttons=[e,i,s,n]}getNewButtonPosition(t,e){return new a(t.x,t.y+Ke.VERTICAL_MARGIN*(e||1))}update(){this.buttons.forEach(t=>t.update())}render(){this.buttons.forEach(t=>t.render())}};Ke.VERTICAL_MARGIN=22;let yi=Ke;class Qi extends Xi{constructor(t,e){super(e),this.image=t,this.renderizer=o.getInstance().renderizer}render(){this.renderizer.drawImage(this.image,this.position.x,this.position.y)}get width(){return this.image.width}get height(){return this.image.height}}class ps{constructor(t,e){this.interval=t,this.speed=e,this.switchDirection=1,this.direction=ct.Down,this.line=0,this.counter=0}update(){this.calculateSway()}render(){this.renderSway()}calculateSway(){this.addValueToDimension(this.line),this.updateCounter()}updateCounter(){this.line=this.speed*this.direction,this.counter++,this.counter===this.interval&&(this.toggleDirection(),this.counter=0)}toggleDirection(){this.direction*=-1*this.switchDirection,this.switchDirection*=-1}}class rr extends ps{constructor(t,e,i){super(e,i),this.visualElement=t}renderSway(){this.visualElement.render()}addValueToDimension(t){this.visualElement.position.y+=t}}const Ht=class Ht{constructor(t){this.mainMenuTitle=t,this.sprite=d.spriteManager.WEB_EDITION_TAG,this.renderProvider=o.getInstance(),this.position=a.Zero}calculatePosition(){const t=this.mainMenuTitle.right-this.sprite.width*.5-this.mainMenuTitle.width*.14,e=this.mainMenuTitle.y+this.mainMenuTitle.height+Ht.GAP;this.position=new a(t,e)}get height(){return this.sprite.height}get axisOfRotation(){return new a(-this.sprite.width*.5,-this.sprite.height*.5)}update(){this.calculatePosition()}render(){const{x:t,y:e}=this.position,{renderizer:i}=this.renderProvider;i.save(),i.translate(t,e),i.rotate(Ht.DEGREES);const s=this.axisOfRotation;i.drawImage(this.sprite,s.x,s.y),i.restore()}};Ht.GAP=20,Ht.DEGREES=-20*Math.PI/180;let Ni=Ht;class nr{constructor(){this.TITLE_SWAY_INTERVAL=20,this.TITLE_SWAY_SPEED=.5,this.sprite=d.spriteManager.TITLE,this.renderProvider=o.getInstance(),this.position=this.calculatePosition(),this.swayEffect=new rr(new Qi(this.sprite,this.position),this.TITLE_SWAY_INTERVAL,this.TITLE_SWAY_SPEED),this.mainMenuWebEditionTag=new Ni(this)}calculatePosition(){const{renderProvider:t}=this;return new a(t.halfScreenWidth-this.sprite.width*.5,t.getMeasureByScreenHeight(.1))}get bottom(){return this.position.y+this.sprite.height+this.mainMenuWebEditionTag.height}get right(){return this.position.x+this.sprite.width}get width(){return this.sprite.width}get y(){return this.position.y}get height(){return this.sprite.height}update(){this.swayEffect.update(),this.mainMenuWebEditionTag.update()}render(){const{x:t,y:e}=this.position;this.renderProvider.renderizer.drawImage(this.sprite,t,e),this.swayEffect.render(),this.mainMenuWebEditionTag.render()}}class Ts{constructor(){this.mainMenuTitle=new nr,this.mainMenuButtonController=new yi(this.mainMenuTitle)}update(){this.mainMenuTitle.update(),this.mainMenuButtonController.update()}render(){this.mainMenuTitle.render(),this.mainMenuButtonController.render()}}class qe{constructor(){const t=J.getInstance();t.change(us.Menu),t.currentTrack.play(),this.background=new me(u.GAME_MENU_SCENE_BACKGROUND_SPEED),this.gameMenuSceneManager=w.getInstance();const e=Os().custom.getInitialMenuScene(()=>new Ts);this.gameMenuSceneManager.changeScene(e)}update(){this.background.update(),this.gameMenuSceneManager.update()}render(){this.background.render(),this.gameMenuSceneManager.render()}}class ar{constructor(){this.renderProvider=o.getInstance(),this.gameControlProvider=Q.getInstance(),this.globalSceneManager=x.getInstance(),this.hasPulsedExitButtonForFirstTime=!1,this.gameExitMessage=new di(new a(this.renderProvider.halfScreenWidth,this.renderProvider.halfScreenHeight)),this._wantToExit=!1,this.waitTimer=new y(()=>this.resetExitStatus(),2e3)}render(){this._wantToExit&&this.gameExitMessage.render()}update(){this.checkExit(),this._wantToExit&&this.waitTimer.update()}get wantToExit(){return this._wantToExit}hasPulseExitButton(){return this.gameControlProvider.hasPulsed(I.Exit)}checkExit(){this.hasPulseExitButton()&&this.hasPulsedExitButtonForFirstTime?(this.hasPulsedExitButtonForFirstTime=!1,this.checkExitStatus()):!this.hasPulseExitButton()&&!this.hasPulsedExitButtonForFirstTime&&(this.hasPulsedExitButtonForFirstTime=!0)}checkExitStatus(){if(this._wantToExit){this.globalSceneManager.changeScene(new qe);return}this._wantToExit=!0,this.waitTimer.start()}resetExitStatus(){this._wantToExit=!1,this.waitTimer.stop()}}class hr{constructor(){this.renderProvider=o.getInstance(),this.position=a.Vertical(this.renderProvider.getMeasureByScreenHeight(_.POSITION_Y_BY_SCREEN)),this.size=new D(this.renderProvider.canvasSize.width,this.renderProvider.getMeasureByScreenHeight(_.HEIGHT_BY_SCREEN))}render(){const{renderizer:t}=this.renderProvider,{position:e,size:i}=this;t.fillStyle=c.Overlay,t.fillRect(e.x,e.y,i.width,i.height)}}class or extends ls{constructor(t){super(),this.value=t}getValue(){return this.value}setValue(t){this.value=t}}class qi extends Xi{constructor(){super(a.Zero),this.renderProvider=o.getInstance()}render(){const{renderizer:t}=this.renderProvider;t.fillStyle=c.Dark,t.fillRect(this.position.x,this.position.y,t.canvas.width,t.canvas.height)}get height(){return this.renderProvider.canvasSize.height}get width(){return this.renderProvider.canvasSize.width}}class Ss{constructor(t,e){this.visualElement=t,this.renderProvider=o.getInstance(),this.opacityRatio=e,this.opacity=0}update(){this.calculateOpacity()}render(){this.renderFade()}renderFade(){this.renderProvider.setOpacity(this.opacity,()=>this.visualElement.render())}hasReachOpacity(t){return this.opacity>=t}}class cr extends Ss{constructor(t,e){super(t,e),this.opacity=1}calculateOpacity(){this.opacity-=this.opacityRatio,this.opacity<=0&&(this.opacity=0)}get isFinished(){return this.opacity<=0}}class dr{constructor(t){this.gameOverController=t}update(){this.gameOverController.update()}render(){this.gameOverController.render()}}class ns{constructor(t){this.gamePauseController=t}render(){this.gamePauseController.render()}update(){this.gamePauseController.update()}}class _e extends Ss{constructor(t,e){super(t,e)}calculateOpacity(){this.opacity+=this.opacityRatio,this.opacity>=1&&(this.opacity=1)}get isFinished(){return this.opacity>=1}}const Bt=class Bt{constructor(t){this.gameManager=t,this.screenFadeInEffect=new _e(new qi,Bt.SCREEN_FADE_IN_EFFECT_SCREEN_OPACITY_INCREMENT),this.timer=new y(()=>this.gameManager.nextGame(),Bt.TIMEOUT_FOR_START_CONTINUATION_OF_THE_GAME)}update(){this.screenFadeInEffect.isFinished?this.timer.isStopped?this.timer.start():this.timer.update():this.screenFadeInEffect.update()}render(){this.screenFadeInEffect.render()}};Bt.SCREEN_FADE_IN_EFFECT_SCREEN_OPACITY_INCREMENT=.02,Bt.TIMEOUT_FOR_START_CONTINUATION_OF_THE_GAME=1e3;let Li=Bt;class lr{constructor(t){this.newGameManager=new Li(t)}render(){this.newGameManager.render()}update(){this.newGameManager.update()}}const Z=class Z{constructor(t,e){this.gameScene=t,this.globalSceneManager=x.getInstance(),this.scoreService=Ji.getScoreService(),this._score=e,this._highScore=this.getHighScore(this._score),this.winStateOfGameManager=new lr(this),this.defeatStateOfGameManager=new dr(t.gameOverController),this.playingStateOfGameManager=new ns(t.gamePauseController),this.currentStateOfGameManager=this.playingStateOfGameManager,this.screenFadeOutEffect=new cr(new qi,Z.SCREEN_FADE_OUT_EFFECT_SCREEN_OPACITY_INCREMENT)}static getScoreFormat(t){return t.toString().padStart(Z.MAX_FIGURE_SCORE,Z.DEFAULT_DIGIT)}static getDefaultScoreFormat(){return Z.DEFAULT_DIGIT.repeat(Z.MAX_FIGURE_SCORE)}get score(){return this._score}get highScore(){return this._highScore}get isFinished(){return this.screenFadeOutEffect.isFinished}getHighScore(t){const e=this.scoreService.getHighScore();return t>e?t:e}update(){this.screenFadeOutEffect.isFinished||this.screenFadeOutEffect.update(),this.currentStateOfGameManager=this.getCurrentStateOfGameManager(),this.currentStateOfGameManager.update()}render(){this.screenFadeOutEffect.render(),this.currentStateOfGameManager.render()}getCurrentStateOfGameManager(){return this.gameScene.enemyHord.noEnemies?this.winStateOfGameManager:this.gameScene.playerManager.noPlayers?this.defeatStateOfGameManager:this.playingStateOfGameManager}syncHighScoreIfIsReached(){this._score>this.highScore&&(this._highScore=this._score)}incrementScore(t){this._score+=t.points,this.syncHighScoreIfIsReached()}saveScore(){if(this._score===0)return;const t=new mi(this._score);this.scoreService.saveScore(t)}isPlaying(){return this.currentStateOfGameManager instanceof ns}nextGame(){this.globalSceneManager.changeScene(_t.NextGame(this))}};Z.MAX_FIGURE_SCORE=7,Z.DEFAULT_DIGIT="0",Z.SCREEN_FADE_OUT_EFFECT_SCREEN_OPACITY_INCREMENT=.03;let de=Z;class ur{constructor(t,e){this.gameManager=e;const i=o.getInstance(),s=new a(i.halfScreenWidth,t.getCenterY());this.value=new wt(new or(this.highScoreIndicator),c.Highlighted,_.FONT_SIZE,s.copy()),this.label=new g("PUNTAJE",c.Light,_.FONT_SIZE,s.copy()),this.value.addOffset(a.Horizontal(_.GAP_COMPONENT*.5)),this.label.addOffset(a.Horizontal(-_.GAP_COMPONENT*.5-this.label.width))}get highScoreIndicator(){return de.getScoreFormat(this.gameManager.score)}update(){this.value.content.setValue(this.highScoreIndicator)}render(){this.label.render(),this.value.render()}}const rt=class rt{constructor(t,e){this.player=t,this.renderProvider=o.getInstance(),this.size=this.calculateSize(),this.position=e.diff(a.Vertical(this.size.height*.5)),this.opacity=1}calculateSize(){const{width:t,height:e}=this.player.sprite;return new D(t*rt.SCALE,e*rt.SCALE)}update(){this.opacity=this.player.isDead?rt.DEAD_PLAYER_OPACITY:rt.LIVE_PLAYER_OPACITY}render(){this.renderProvider.setOpacity(this.opacity,()=>{this.renderProvider.renderizer.drawImage(this.player.sprite,this.position.x,this.position.y,this.size.width,this.size.height)})}};rt.SCALE=.8,rt.LIVE_PLAYER_OPACITY=1,rt.DEAD_PLAYER_OPACITY=.25;let Mi=rt;const re=class re{constructor(t,e){this.player=t,this.playerSprite=new Mi(this.player,e),this.lifeText=new g(this.lifeCounter,c.Light,_.FONT_SIZE,e),this.lifeText.addOffset(a.Horizontal(this.playerSprite.size.width+re.GAP))}update(){this.playerSprite.update(),this.lifeText.content=this.lifeCounter}render(){this.playerSprite.render(),this.lifeText.render()}get width(){return this.playerSprite.size.width+re.GAP+this.lifeText.width}get lifeCounter(){return`x${this.player.lifes}`}};re.GAP=10;let Ri=re;const Ze=class Ze{constructor(t,e){this.gameHudPlayerLifes=new Map;const i=o.getInstance(),s=e.getCenterY();let n=i.getMeasureByScreenWidth(_.HORIZONTAL_PADDING);t.forEachPlayer(h=>{const l=new Ri(h,new a(n,s));this.gameHudPlayerLifes.set(h.id,l),n+=l.width+Ze.GAP})}update(){this.gameHudPlayerLifes.forEach(t=>t.update())}render(){this.gameHudPlayerLifes.forEach(t=>t.render())}};Ze.GAP=35;let vi=Ze;class gr{constructor(t,e){this.gameManager=e;const{canvasSize:i}=o.getInstance(),s=i.width-t.getHorizontalPadding(),n=new a(s,t.getCenterY());this.value=new g(this.scoreIndicator,c.Highlighted,_.FONT_SIZE,n.copy()),this.label=new g(`MAYOR
PUNTAJE`,c.Light,_.FONT_SIZE,n.copy()),this.value.addOffset(a.Horizontal(-this.value.width)),this.label.addOffset(a.Horizontal(-this.value.width-this.label.width-_.GAP_COMPONENT))}get scoreIndicator(){return de.getScoreFormat(this.gameManager.highScore)}update(){this.value.content=this.scoreIndicator}render(){this.value.content=this.scoreIndicator,this.label.render(),this.value.render()}}const X=class X{constructor(t,e){this.renderProvider=o.getInstance(),this.hudBackground=new hr,this.hudPlayerLifes=new vi(t,this),this.hudScore=new ur(this,e),this.hudHighScore=new gr(this,e)}update(){this.hudPlayerLifes.update(),this.hudScore.update(),this.hudHighScore.update()}render(){this.hudBackground.render(),this.hudPlayerLifes.render(),this.hudScore.render(),this.hudHighScore.render()}getHorizontalPadding(){return this.renderProvider.getMeasureByScreenWidth(X.HORIZONTAL_PADDING)}getCenterY(){const{renderProvider:t}=this;return t.getMeasureByScreenHeight(X.POSITION_Y_BY_SCREEN)+t.getMeasureByScreenHeight(X.HEIGHT_BY_SCREEN/2)}};X.HEIGHT_BY_SCREEN=.12,X.POSITION_Y_BY_SCREEN=.88,X.HORIZONTAL_PADDING=.05,X.FONT_SIZE=18,X.GAP_COMPONENT=20;let _=X;class Is extends ps{constructor(t,e,i){super(e,i),this.visualElement=t}renderSway(){this.visualElement.render()}addValueToDimension(t){this.visualElement.position.x+=t}}const L=class L{constructor(){this.renderProvider=o.getInstance();const t=d.spriteManager.GAME_OVER,e=this.renderProvider.getCenterPosition(new D(t.width,t.height));this.screenFadeInEffect=new _e(new qi,L.GAME_OVER_SCREEN_OPACITY_INCREMENT),this.gameOverSpriteFadeInEffect=new _e(new Qi(t,e),L.GAME_OVER_FADE_INTERVAL),this.backToMainMenuMessageSwayEffect=L.BackToMainMenuMessageSwayEffect(this.renderProvider)}get isMounted(){return this.screenFadeInEffect.isFinished}static BackToMainMenuMessageSwayEffect(t){const e=new wt(new Et("game_scene.text.game_over"),c.Light,L.GAME_OVER_FONT_SIZE,t.getPositionByScreen(.5,.8));return e.addOffset(a.Horizontal(-e.width*.5)),new Is(new ji(e),L.GAME_OVER_SWAY_INTERVAL,L.GAME_OVER_SWAY_SPEED)}update(){this.screenFadeInEffect.update(),this.screenFadeInEffect.hasReachOpacity(.5)&&this.gameOverSpriteFadeInEffect.update(),this.screenFadeInEffect.isFinished&&this.backToMainMenuMessageSwayEffect.update()}render(){this.screenFadeInEffect.render(),this.gameOverSpriteFadeInEffect.render(),this.screenFadeInEffect.isFinished&&this.backToMainMenuMessageSwayEffect.render()}};L.GAME_OVER_SCREEN_OPACITY_INCREMENT=.02,L.GAME_OVER_FADE_INTERVAL=.01,L.GAME_OVER_SWAY_INTERVAL=20,L.GAME_OVER_SWAY_SPEED=.3,L.GAME_OVER_FONT_SIZE=20;let Ci=L;class Er{constructor(){this.gameOverScreen=new Ci,this.gameControlProvider=Q.getInstance(),this.globalSceneManager=x.getInstance(),this.soundtrackManager=J.getInstance(),this.hasPulsedStartButtonForFirstTime=!1}hasPulsedStartButton(){const t=this.gameControlProvider.hasPulsed(I.Enter);return t&&!this.hasPulsedStartButtonForFirstTime&&(this.hasPulsedStartButtonForFirstTime=!0),!t&&this.hasPulsedStartButtonForFirstTime}muteSoundtrack(){const t=this.soundtrackManager.currentTrack;t.audio.paused||(t.volumeController.setVolume(ae.Muted),t.audio.volume===0&&t.stop())}get isGameOver(){return this.gameOverScreen.isMounted}update(){this.gameOverScreen.update(),this.isGameOver&&this.muteSoundtrack(),this.hasPulsedStartButton()&&this.globalSceneManager.changeScene(new qe)}render(){this.gameOverScreen.render()}}class pr{constructor(t,e,i,s){this.enemyHord=t,this.shieldLine=e,this.playerManager=i,this.gameManager=s}isInArea(t,e){return t.position.y+t.height>=e.position.y}checkPlayerContact(t,e){e.isDead||!this.isInArea(t,e)||(e.kill(),this.playerManager.noPlayers&&this.gameManager.saveScore())}checkShieldContact(t,e){e.isDestroyed||!this.isInArea(t,e)||(e.smash(),this.shieldLine.destroy(e))}update(){this.enemyHord.forEachEnemy(t=>{this.playerManager.forEachPlayer(e=>this.checkPlayerContact(t,e)),this.shieldLine.forEachShield(e=>this.checkShieldContact(t,e))})}}class _t{constructor(t,e){this.playerManager=t;const i=J.getInstance();i.change(us.Game),i.currentTrack.play(),this.background=new me(u.GAME_SCENE_BACKGROUND_SPEED),this.enemyHord=new Cs,this.shieldLine=new Ki,this.explosionEffectManager=V.getInstance(),this.shieldCollisionManager=new Fs(this.shieldLine),this.gamePauseController=new Ys,this.gameOverController=new Er,this.gameManager=new de(this,e||0),this.enemyCollisionManager=new Hs(this.enemyHord,this.gameManager),this.playerCollisionManager=new Bs(this.playerManager,this.gameManager),this.laserController=Tt.getInstance(),this.gameHud=new _(this.playerManager,this.gameManager),this.gameExitController=new ar,this.destructionByEnemyHordContact=new pr(this.enemyHord,this.shieldLine,this.playerManager,this.gameManager)}static Initial(t){return new _t(t)}static NextGame(t){const e=t.gameScene.playerManager;return e.forEachPlayer(i=>{i.resetPosition(),i.incrementLifes()}),new _t(e,t.score)}update(){if(this.gameManager.update(),this.gameOverController.isGameOver||this.gamePauseController.isPaused){this.gameExitController.resetExitStatus();return}this.background.update(),this.playerManager.update(),this.enemyHord.update(),this.shieldLine.update(),this.explosionEffectManager.update(),this.shieldCollisionManager.update(),this.enemyCollisionManager.update(),this.playerCollisionManager.update(),this.destructionByEnemyHordContact.update(),this.laserController.update(),this.gameExitController.update(),this.gameHud.update()}render(){this.background.render(),this.playerManager.render(),this.enemyHord.render(),this.shieldLine.render(),this.explosionEffectManager.render(),this.laserController.render(),this.gameHud.render(),this.gameManager.render(),this.gameExitController.render()}}class Tr extends Vt{constructor(t,e,i){super(t.position.copy(),i[0],1.3),this.gap=e,this.animator=new Ot(i,120),this.adjustPosition(t)}adjustPosition(t){this._position=t.position.sum(new a(-this.width*.5+t.width*.5,t.height*.5+this.gap))}update(){this.animator.update(),this._sprite=this.animator.currentFrame}render(){this.renderProvider.renderizer.drawImage(this.sprite,this.position.x,this.position.y,this.width,this.height)}}class Sr{constructor(t,e,i){this.maxLength=i,this.display=new g(this.getDisplay(t),c.Light,23,e),this._value=t}getDisplay(t){const e=Array.from({length:this.maxLength}).fill("_");return t.split("").forEach((i,s)=>e[s]=i),e.join(" ")}syncDisplay(){this.display.content=this.getDisplay(this._value)}get width(){return this.display.width}get value(){return this._value}get isLimitReached(){return this.value.length>=this.maxLength}append(t){this._value+=t,this.syncDisplay()}delete(){this._value=this.value.substring(0,this.value.length-1),this.syncDisplay()}addOffset(t){this.display.addOffset(t)}render(){this.display.render()}}class Ir{constructor(t,e,i){this._position=e;const{key:s,keyVariant:n}=t;this.allSprites=n.sprites,this.sprite=n.sprites.base,this.mouseAdapter=new Je(e,new D(this.sprite.width,this.sprite.height),()=>i(s)),this.text=new g(s,c.Light,n.fontSize,e.copy()),this.text.addOffset(new a(this.sprite.width*.5-this.text.width*.5,this.sprite.height*.5)),this.renderProvider=o.getInstance()}get position(){return this._position}get width(){return this.sprite.width}get height(){return this.sprite.height}addOffset(t){this._position.x+=t.x,this._position.y+=t.y,this.text.addOffset(t)}update(){this.mouseAdapter.update(),this.sprite=this.mouseAdapter.isHover?this.allSprites.hover:this.allSprites.base}render(){const{x:t,y:e}=this._position;this.renderProvider.renderizer.drawImage(this.sprite,t,e),this.text.render()}}class pt{constructor(t,e){this.sprites=t,this.fontSize=e}static get Default(){return new pt(d.spriteManager.KEYBOARD_INPUT_KEY_DEFAULT,18)}static get Outstanding(){return new pt(d.spriteManager.KEYBOARD_INPUT_KEY_OUTSTANDING,18)}static get OutstandingLarge(){return new pt(d.spriteManager.KEYBOARD_INPUT_KEY_OUTSTANDING_LARGE,12)}}const nt=class nt{constructor(t,e){this.display=e,this.keys=this.getKeys([...this.getKeyDataInRange(97,122,pt.Default),...this.getKeyDataInRange(48,57,pt.Outstanding),{key:".",keyVariant:pt.Outstanding},{key:"Backspace",keyVariant:pt.OutstandingLarge}],t),this.adjustPosition()}getKeyDataInRange(t,e,i){const s=[];for(let n=t;n<=e;n++)s.push({key:String.fromCharCode(n),keyVariant:i});return s}calculateWidth(){const t=this.keys[0],e=this.keys[nt.KEY_BY_ROW-1];return e.position.x+e.width-t.position.x}getKeys(t,e){let i=e.x,s=e.y;return t.map((h,l)=>{const p=l+1,P=new Ir(h,new a(i,s),St=>this.editDisplay(St));return p%nt.KEY_BY_ROW!==0?i+=P.width+nt.GAP:(i=e.x,s+=P.height+nt.GAP),P})}editDisplay(t){t==="Backspace"?this.display.delete():this.display.isLimitReached||this.display.append(t)}adjustPosition(){const t=this.calculateWidth(),e=a.Horizontal(-t*.5);this.keys.forEach(i=>i.addOffset(e))}get right(){const t=this.keys[nt.KEY_BY_ROW-1];return t.position.x+t.width}update(){this.keys.forEach(t=>t.update())}render(){this.keys.forEach(t=>t.render())}};nt.GAP=15,nt.KEY_BY_ROW=13;let xi=nt;class Zt{constructor(t,e,i,s){e=e.substring(0,s),this.backToSceneButton=new R(()=>i(e)),this.title=Zt.Title(t),this.display=Zt.Display(e,s);const n=o.getInstance();this.virtualKeyboard=new xi(n.getPositionByScreen(.5,.4),this.display),this.continueButton=Zt.ContinueButton(i,this.display,this.virtualKeyboard)}static Title(t){const e=o.getInstance(),i=new g(t,c.Highlighted,22,e.getPositionByScreen(.5,.2));return i.addOffset(a.Horizontal(-i.width*.5)),i}static Display(t,e){const i=o.getInstance(),s=new Sr(t,i.getPositionByScreen(.5,.28),e);return s.addOffset(a.Horizontal(-s.width*.5)),s}static ContinueButton(t,e,i){const s=w.getInstance(),n=220;return new W(new a(i.right-n,o.getInstance().getMeasureByScreenHeight(.72)),"Continuar >",v.Default,new F(new D(n,70)),h=>{s.changeScene(t(e.value)),h.removeClickListener()})}update(){this.backToSceneButton.update(),this.virtualKeyboard.update(),this.continueButton.update()}render(){this.backToSceneButton.render(),this.title.render(),this.display.render(),this.virtualKeyboard.render(),this.continueButton.render()}}class fr{constructor(t){this._position=t,this.renderProvider=o.getInstance(),this.icons=d.spriteManager.EDIT_ICONS,this.currentIcon=this.icons.base,this.isActive=!1}get width(){return this.currentIcon.width}get height(){return this.currentIcon.height}get position(){return this._position}addOffset(t){this._position=this._position.sum(t)}update(){this.currentIcon=this.isActive?this.icons.active:this.icons.base}render(){const{x:t,y:e}=this._position;this.renderProvider.renderizer.drawImage(this.currentIcon,t,e)}}const j=class j{constructor(t,e,i,s,n){this.hasValue=s.length>0;const h=t.height+e;this.icon=j.Icon(t,h),this.text=j.Text(this.hasValue?s:i,t,this.icon,h),this.centerAllComponents(t),this.mouseAdapter=j.MouseAdapter(this.icon,new D(this.calculateWidth(),this.height),s,n)}static Icon(t,e){return new fr(t.position.sum(a.Vertical(e)))}static Text(t,e,i,s){const n=new g(t,c.Light,14,e.position.copy()),h=new a(i.width+j.GAP,s+n.height*.5);return n.addOffset(h),n}static MouseAdapter(t,e,i,s){const n=w.getInstance(),h=new Je(t.position.copy(),e,l=>{l.removeClickListener(),n.changeScene(new Zt("INGRESA TU NICKNAME",i,s,u.NICKNAME_MAX_LENGTH))});return h.padding={left:4,right:14,top:8,bottom:12},h}calculateWidth(){return this.icon.width+this.text.width+j.GAP}get height(){return Math.max(this.icon.height,this.text.height)}centerAllComponents(t){const e=a.Horizontal(t.width*.5-this.calculateWidth()*.5);this.icon.addOffset(e),this.text.addOffset(e)}update(){this.icon.isActive=this.mouseAdapter.isHover,this.icon.update(),this.mouseAdapter.update(),this.text.opacity=this.hasValue?1:j.PLACEHOLDER_OPACITY}render(){this.icon.render(),this.text.render()}};j.PLACEHOLDER_OPACITY=.25,j.GAP=15;let Di=j;const ne=class ne{constructor(t,e,i,s){this.title=g.NewTextContentWithDefaultSize(t.title,c.Light,e),this.character=new Tr(this.title,ne.VERTICAL_GAP,t.sprites),this.input=new Di(this.character,ne.VERTICAL_GAP,t.placeholder,i,s)}update(){this.character.update(),this.input.update()}render(){this.title.render(),this.character.render(),this.input.render()}};ne.VERTICAL_GAP=25;let ye=ne;class le{constructor(t,e,i){this.title=t,this.sprites=e,this.placeholder=i}static get PlayerOne(){return new le("J1",d.spriteManager.NPC_SHIP_ONE,"Jugador 1")}static get PlayerTwo(){return new le("J2",d.spriteManager.NPC_SHIP_TWO,"Jugador 2")}}class mr{constructor(t,e,i,s){this.position=t,this.playerControls=i;const n=o.getInstance().canvasSize.width;this.boundary=n-e,this.gameControlProvider=Q.getInstance(),this.idleAnimator=new Ot(s.idle,E.IDLE_ANIMATION_INTERVAL),this.movingAnimator=new Ot(s.moving,E.MOVING_ANIMATION_INTERVAL),this.isMoving=!1}update(){this.isMoving=!1,this.moveLeft(),this.moveRight(),this.animator.update()}get currentFrameAnimation(){return this.animator.currentFrame}reachLeftBoundary(){return this.position.x-E.MOVEMENT_SPEED>0}reachRightBoundary(){return this.position.x+E.MOVEMENT_SPEED<=this.boundary}moveLeft(){this.gameControlProvider.hasPulsed(this.playerControls.left)&&(this.isMoving=!0,this.reachLeftBoundary()&&(this.position.x-=E.MOVEMENT_SPEED))}moveRight(){this.gameControlProvider.hasPulsed(this.playerControls.right)&&(this.isMoving=!0,this.reachRightBoundary()&&(this.position.x+=E.MOVEMENT_SPEED))}get animator(){return this.isMoving?this.movingAnimator:this.idleAnimator}}class Or{constructor(){this.left=I.LeftPlayerOne,this.right=I.RightPlayerOne,this.fire=I.FirePlayerOne}}class wr{constructor(t,e){this.playerControls=t,this.generateLaser=e,this.gameControlProvider=Q.getInstance(),this.laserController=Tt.getInstance(),this.refireTimer=new y(()=>this.refireTimer.stop(),E.FIRE_RATIO),this.timer=new y(()=>this.fire(),E.FIRE_RATIO),this.hasPulsedFireButtonForFirstTime=!1}update(){this.checkFireRatio()}canStartFire(){return this.hasPulsedFireButton()&&this.hasPulsedFireButtonForFirstTime&&this.refireTimer.isStopped}fireButtonHasReleased(){return!this.hasPulsedFireButton()&&!this.hasPulsedFireButtonForFirstTime}startFire(){this.refireTimer.start(),this.fire(),this.timer.start(),this.hasPulsedFireButtonForFirstTime=!1}resetFireInitialState(){this.timer.stop(),this.hasPulsedFireButtonForFirstTime=!0}checkFireRatio(){this.refireTimer.update(),this.timer.update(),this.canStartFire()?this.startFire():this.fireButtonHasReleased()&&this.resetFireInitialState()}fire(){this.laserController.generate(this.generateLaser())}hasPulsedFireButton(){return this.gameControlProvider.hasPulsed(this.playerControls.fire)}}class Pr{constructor(){this._isInvincible=!1,this._isVisible=!0,this.oscillations=E.INVINCIBILITY_OSCILLATIONS,this.timer=new y(()=>this.oscillate(),E.INVINCIBILITY_OSCILLATION_INTERVAL)}get isInvincible(){return this._isInvincible}get isVisible(){return this._isVisible}makeInvincibility(){this._isInvincible=!0,this.oscillations=E.INVINCIBILITY_OSCILLATIONS,this.timer.start()}undoInvincibility(){this._isInvincible=!1,this.timer.stop()}invincibilityHasFinished(){return this.oscillations===0&&this._isVisible}oscillate(){if(this.invincibilityHasFinished()){this.undoInvincibility();return}this._isVisible=!this._isVisible,this._isVisible&&this.oscillations--}update(){this.timer.update()}}class Ar{constructor(){this.left=I.LeftPlayerTwo,this.right=I.RightPlayerTwo,this.fire=I.FirePlayerTwo}}class ue{constructor(t){this.sprite=t}static get One(){return new ue(d.spriteManager.SHIP_ONE.laser)}static get Two(){return new ue(d.spriteManager.SHIP_TWO.laser)}}class _r extends ds{constructor(t,e){super(u.PLAYER_LASER_TAG,E.LASER_SPEED,ct.Up,e.sprite,t)}}const ut=class ut extends Vt{constructor(t,e,i,s,n){super(s,e.moving[0]),this.id=t,this.sprites=e,this.controls=i,this.laserCharacter=n,this._lifes=u.PLAYER_DAMAGE_CAPACITY,this.movementController=new mr(s,this.width,i,e),this.fireController=new wr(i,()=>new _r(s.sum(a.Horizontal(this.width*.5)),n)),this.addOffsetX(s),this.collider=new Qe(this,E.COLLIDER_RADIUS),this.invincibleController=new Pr,this.initialPosition=s.copy(),this.explosionEffectManager=V.getInstance()}static PlayerOne(t){const e=d.spriteManager;return new ut(ut.PLAYER_ONE_ID,e.SHIP_ONE,new Or,t,ue.One)}static PlayerTwo(t){const e=d.spriteManager;return new ut(ut.PLAYER_TWO_ID,e.SHIP_TWO,new Ar,t,ue.Two)}addOffsetX(t){t.x-=this.width*.5}update(){this.isDead||(this.movementController.update(),this.fireController.update(),this.invincibleController.isInvincible&&this.invincibleController.update())}render(){if(this.isDead)return;const{renderizer:t}=this.renderProvider;this._sprite=this.movementController.currentFrameAnimation,this.invincibleController.isVisible&&t.drawImage(this._sprite,this._position.x,this._position.y,this.width,this.height)}damage(){if(this.isDead){this.explosionEffectManager.play(this,!1);return}this._lifes--,this.invincibleController.makeInvincibility()}resetPosition(){this._position.x=this.initialPosition.x,this._position.y=this.initialPosition.y}incrementLifes(){this._lifes+=u.WINNING_PLAYER_LIFE_INCREMENT}kill(){this._lifes=0}get isInvincible(){return this.invincibleController.isInvincible}get isDead(){return this._lifes<=0}get lifes(){return this._lifes}};ut.PLAYER_ONE_ID="P1",ut.PLAYER_TWO_ID="P2";let kt=ut;const Xe=class Xe extends Vt{constructor(t,e){super(t,e,Xe.PLAYER_SELECTOR_SCALE)}set position(t){this._position=t}update(){}render(){this.renderProvider.renderizer.drawImage(this.sprite,this._position.x,this._position.y,this.width,this.height)}};Xe.PLAYER_SELECTOR_SCALE=.5;let Fi=Xe;const gt=class gt{constructor(t,e){this.player=t,this.nickname=new g(e,c.PlayerHUD,gt.FONT_SIZE,a.Zero),this.selector=new Fi(a.Zero,d.spriteManager.PLAYER_SELECTOR)}adjustFigurePositions(){const t=this.player.width*.5;this.selector.position=this.player.position.sum(new a(t-this.selector.width*.5,-gt.SELECTOR_GAP)),this.nickname.position=this.player.position.sum(new a(t-this.nickname.width*.5,this.player.height+gt.NAME_GAP))}update(){this.adjustFigurePositions(),this.selector.update()}render(){this.nickname.render(),this.selector.render()}};gt.NAME_GAP=13,gt.SELECTOR_GAP=17,gt.FONT_SIZE=11;let Hi=gt;class as extends kt{constructor(t,e){super(t.id,t.sprites,t.controls,t.position,t.laserCharacter),this.nickname=e,this.displayPlayerFigure=new Hi(t,e)}shouldSkipRendering(){return this.isDead||this.nickname.length===0}update(){super.update(),!this.shouldSkipRendering()&&this.displayPlayerFigure.update()}render(){super.render(),!this.shouldSkipRendering()&&this.displayPlayerFigure.render()}}class zt{constructor(t){this.players=new Map(t.map(e=>[e.id,e]))}static Invidual(){const t=o.getInstance();return new zt([kt.PlayerOne(t.getPositionByScreen(E.PLAYER_SPAWN_PIVOT_POSITION_X_IN_SCREEN,E.PLAYER_SPAWN_POSITION_Y_IN_SCREEN))])}static Multiplayer(t){const e=o.getInstance();return new zt([new as(kt.PlayerOne(e.getPositionByScreen(E.PLAYER_SPAWN_PIVOT_POSITION_X_IN_SCREEN-E.PLAYER_SPAWN_DISTANCE_TO_PIVOT_POSITION_X_IN_SCREEN,E.PLAYER_SPAWN_POSITION_Y_IN_SCREEN)),t.playerOne),new as(kt.PlayerTwo(e.getPositionByScreen(E.PLAYER_SPAWN_PIVOT_POSITION_X_IN_SCREEN+E.PLAYER_SPAWN_DISTANCE_TO_PIVOT_POSITION_X_IN_SCREEN,E.PLAYER_SPAWN_POSITION_Y_IN_SCREEN)),t.playerTwo)])}update(){this.forEachPlayer(t=>t.update())}render(){this.forEachPlayer(t=>t.render())}forEachPlayer(t){this.players.forEach(t)}get noPlayers(){return Array.from(this.players.values()).every(({isDead:e})=>e)}}class Mt{constructor(t){this.backToMainMenuButton=R.BackToOfflineGameModeMenuButton();const e=o.getInstance(),i=.32;this.nicknameCards=[new ye(le.PlayerOne,e.getPositionByScreen(.33,i),t.playerOne,s=>new Mt({...t,playerOne:s})),new ye(le.PlayerTwo,e.getPositionByScreen(.63,i),t.playerTwo,s=>new Mt({...t,playerTwo:s}))],this.playButton=Mt.PlayButton(t)}static Initial(){return new Mt({playerOne:"",playerTwo:""})}static PlayButton(t){const e=o.getInstance(),i=F.Medium,s=x.getInstance();return new W(e.getPositionByScreen(.5,.72).diff(a.Horizontal(i.value.width*.5)),"¡Jugar!",v.Outstanding,i,n=>{n.removeClickListener(),s.changeScene(_t.Initial(zt.Multiplayer(t)))})}update(){this.backToMainMenuButton.update(),this.nicknameCards.forEach(t=>t.update()),this.playButton.update()}render(){this.backToMainMenuButton.render(),this.nicknameCards.forEach(t=>t.render()),this.playButton.render()}}class Yt{constructor(t){this.sprites=t}static get PlayerOne(){return new Yt(d.spriteManager.NPC_SHIP_ONE)}static get SecondOne(){return new Yt(d.spriteManager.NPC_SHIP_TWO)}}const at=class at{constructor(t,e,i,s,n){this.direction=e,this.shipVariants=n,this.button=new W(t,i,v.Default,F.Medium,h=>{s(h),h.removeClickListener()}),this.ships=n.map((h,l)=>new Lt(h.sprites,this.button,l)),this.adjustShipPosition(this.button,e)}static Invidual(t){const e=x.getInstance();return new at(t,ct.Down,"Invidual",()=>e.changeScene(_t.Initial(zt.Invidual())),[Yt.PlayerOne])}static Multiplayer(t){const e=w.getInstance();return new at(t,ct.Up,"Multijugador",()=>e.changeScene(Mt.Initial()),[Yt.PlayerOne,Yt.SecondOne])}get height(){return Lt.HEIGHT}adjustShipPosition(t,e){const i=t.width*.5-this.calculateShipGroupWidth()*.5,s=(t.height*.5+Lt.HEIGHT*.5+at.VERTICAL_GAP)*e;this.ships.forEach((n,h)=>{n.position.x+=i,n.position.y+=s,h>0&&(n.position.x+=at.HORIZONTAL_GAP)})}calculateShipGroupWidth(){const t=at.HORIZONTAL_GAP*(this.ships.length-1);return this.ships.reduce(e=>e+Lt.WIDTH,0)+t}update(){this.button.update(),this.ships.forEach(t=>{t.update(),this.button.isHover?t.focus():t.blur()})}render(){this.button.render(),this.ships.forEach(t=>t.render())}};at.VERTICAL_GAP=60,at.HORIZONTAL_GAP=30;let Ne=at;class ts{constructor(){this.backToMainMenuButton=R.BackToGameModeMenuScene();const t=o.getInstance();this.modeButtons=[Ne.Invidual(t.getPositionByScreen(.24,.3)),Ne.Multiplayer(t.getPositionByScreen(.55,.7))]}update(){this.backToMainMenuButton.update(),this.modeButtons.forEach(t=>t.update())}render(){this.backToMainMenuButton.render(),this.modeButtons.forEach(t=>t.render())}}class fs{constructor(){this.backToMainMenuButton=R.BackToMainMenuButton();const t=o.getInstance(),e=w.getInstance();this.gameModeButtons=[new fe("Offline",`Juega en solitario o con un
amigo localmente`,oe.Default,t.getPositionByScreen(.24,.4),()=>e.changeScene(new ts)),new fe("Online",`Juega online con un amigo
sin importar la distancia`,oe.Outstanding,t.getPositionByScreen(.55,.4),()=>alert("Soy modo online..."))]}update(){this.backToMainMenuButton.update(),this.gameModeButtons.forEach(t=>t.update())}render(){this.backToMainMenuButton.render(),this.gameModeButtons.forEach(t=>t.render())}}class R extends W{constructor(t){const e=w.getInstance(),i=F.Small;super(R.calculatePosition(i.value),"VOLVER",v.Default,i,s=>{s.removeClickListener(),e.changeScene(t())})}static BackToGameModeMenuScene(){return new R(()=>new fs)}static BackToMainMenuButton(){return new R(()=>new Ts)}static BackToOfflineGameModeMenuButton(){return new R(()=>new ts)}static calculatePosition(t){const{canvasSize:e}=o.getInstance();return new a(e.width*.08-t.width*.5,e.height*.09-t.height*.5)}}const M=class M{constructor(t){const e=o.getInstance();this.title=new g(M.TITLE,c.Highlighted,M.FONT_SIZE_TITLE,new a(e.getMeasureByScreenWidth(.5),t.centerY)),this.description=new g(M.DESCRIPTION,c.Light,M.FONT_SIZE_DESCRIPTION,new a(e.getMeasureByScreenWidth(.5),this.title.position.y+M.GAP_CONTENT)),this.title.alignment="center",this.description.alignment="center";const s=-(this.title.height+this.description.height+M.GAP_CONTENT)*.5;this.title.addOffset(a.Vertical(s)),this.description.addOffset(a.Vertical(s+this.description.height))}render(){this.title.render(),this.description.render()}};M.TITLE="NO EXISTEN REGISTROS",M.DESCRIPTION=`Juega unas partidas en solitario o con tus 
amigos y la próxima vez verán sus puntajes =D.`,M.GAP_CONTENT=12,M.FONT_SIZE_TITLE=22,M.FONT_SIZE_DESCRIPTION=16;let Bi=M;const je=class je{};je.SHIP_ONE_MOVEMENT=Object.freeze({speed:10,speedTarget:0,deceleration:.0715}),je.SHIP_TWO_MOVEMENT=Object.freeze({speed:12,speedTarget:0,deceleration:.14});let Le=je;class yr{constructor(){const t=o.getInstance();this.shipOne=bt.OneShip(t.getPositionByScreen(.28,1.2),Le.SHIP_ONE_MOVEMENT),this.shipTwo=bt.TwoShip(t.getPositionByScreen(.72,1.4),Le.SHIP_TWO_MOVEMENT)}get hasPassedScreen(){return[this.shipOne,this.shipTwo].every(t=>t.hasPassedScreen)}forward(){this.shipOne.forward(),this.shipTwo.forward()}render(){this.shipOne.render(),this.shipTwo.render()}}const $e=class $e{constructor(){this.backToMainMenuButton=R.BackToMainMenuButton(),this.overlayBackground=new $i(.35,$e.OVERLAY_BACKGROUND_HEIGHT),this.ships=new yr,this.content=new Bi(this.overlayBackground)}update(){if(this.backToMainMenuButton.update(),!this.ships.hasPassedScreen){if(this.overlayBackground.expanded){this.ships.forward();return}this.overlayBackground.expand()}}render(){this.backToMainMenuButton.render(),this.overlayBackground.render(),this.content.render(),this.ships.render()}};$e.OVERLAY_BACKGROUND_HEIGHT=.28;let Me=$e;class pe{constructor(t){this.custom=t}init(){this.withChangeLang()}withChangeLang(){const t=ht.getInstance();window.changeLang=e=>t.change(e)}}function Te(r,t){const{DEV:e}={VITE_ROOT_DIRECTORY:"/invasores_p_web_sandbox",VITE_BUILD_DIRECTORY:"./invasores_p_web_sandbox/build",BASE_URL:"/invasores_p_web_sandbox",MODE:"sandbox",DEV:!1,PROD:!0,SSR:!1};return e?t():r()}const ms="default",hs=new Map(Object.entries({manuel:new pe({getInitialMenuScene:r=>Te(r,()=>new ts),getInitialGlobalScene:r=>Te(r,()=>new qe)}),ausubel:new pe({getInitialMenuScene:r=>Te(r,()=>_t.Initial(zt.Multiplayer({playerOne:"ANUEL",playerTwo:"Auschberg"}))),getInitialGlobalScene:r=>r()}),jose:new pe({getInitialMenuScene:r=>Te(r,()=>new Me),getInitialGlobalScene:r=>r()}),[ms]:new pe({getInitialMenuScene:r=>r(),getInitialGlobalScene:r=>r()})}));function Os(){return hs.get({}.VITE_DEBUGGING_SET)||hs.get(ms)}const b=class b{constructor(t){this.game=t,this.fps=0,this.frames=0,this.nowTime=performance.now(),this.lastTime=0,this.elapsedTime=0,this.renderProvider=o.getInstance(),this.textContent=new g(`FPS: ${this.fps}`,c.FPS,b.FONT_SIZE,this.renderProvider.getPositionByScreen(.94,.05))}count(){this.nowTime=performance.now(),this.elapsedTime+=this.nowTime-this.lastTime,this.lastTime=this.nowTime,this.elapsedTime>=b.FRAME_PER_MILLIS&&(this.game.update(),this.game.render(),this.displayFps(),this.frames++,this.elapsedTime=0),this.frames>=b.FPS&&(this.fps=this.frames,this.frames=0)}displayFps(){const{textContent:t,fps:e}=this;t._content=`FPS: ${e}`,t.render()}};b.MILLIS_PER_SECOND=1e3,b.FPS=90,b.FRAME_PER_MILLIS=b.MILLIS_PER_SECOND/b.FPS,b.FONT_SIZE=14;let ki=b;class Nr{constructor(t,e){this.position=t,this.sprites=e;const i=x.getInstance();this.mouseAdapter=new Je(this.position,new D(e.base.width,e.base.height),s=>{s.removeClickListener(),i.changeScene(new qe)}),this.renderProvider=o.getInstance(),this.sprite=e.base}update(){this.mouseAdapter.update(),this.sprite=this.mouseAdapter.isHover?this.sprites.hover:this.sprites.base}render(){const{x:t,y:e}=this.position;this.renderProvider.renderizer.drawImage(this.sprite,t,e)}}const O=class O{constructor(){this.renderProvider=o.getInstance(),this.background=new gs(c.Dark),this.sprites=d.spriteManager.SPLASH_LOGO;const t=this.sprites.base,e=O.BasePosition(this.renderProvider,t);this.splashSpriteFadeInEffect=new _e(new Qi(t,e),O.SPLASH_FADE_INTERVAL_INTERVAL),this.splashStartGameButton=new Nr(e,this.sprites);const i=O.GoToMenuMessage(this.splashStartGameButton,this.sprites);this.centerAllComponents(e,i),this.backToMainMenuMessageSwayEffect=new Is(new ji(i),O.SPLASH_TEXT_INTERVAL,O.SPLASH_TEXT_SPEED)}update(){this.splashSpriteFadeInEffect.isFinished?this.splashStartGameButton.update():this.splashSpriteFadeInEffect.update(),this.backToMainMenuMessageSwayEffect.update()}render(){this.background.render(),this.splashSpriteFadeInEffect.render(),this.splashSpriteFadeInEffect.isFinished?this.splashStartGameButton.render():this.splashSpriteFadeInEffect.render(),this.backToMainMenuMessageSwayEffect.render()}centerAllComponents(t,e){const i=this.renderProvider.halfScreenHeight-this.calculateTotalHeight(e)*.5;t.y+=i,e.addOffset(a.Vertical(i))}calculateTotalHeight(t){return this.sprites.base.height+O.SPLASH_TEXT_GAP+t.height}static GoToMenuMessage(t,e){const i=e.base,s=new wt(new Et("splash_scene.text.start"),c.Light,O.SPLASH_TEXT_FONT_SIZE,t.position);return s.addOffset(new a(-s.width*.5+i.width*.5,i.height+O.SPLASH_TEXT_GAP)),s}static BasePosition(t,e){return new a(t.halfScreenWidth-e.width*.5,0)}};O.SPLASH_FADE_INTERVAL_INTERVAL=.05,O.SPLASH_TEXT_FONT_SIZE=20,O.SPLASH_TEXT_SPEED=.5,O.SPLASH_TEXT_INTERVAL=10,O.SPLASH_TEXT_GAP=40;let Yi=O;class Lr{constructor(){this.renderProvider=o.getInstance(),this.cursorMouseManager=ft.getInstance(),this.fpsController=new ki(this),this.globalSceneManager=x.getInstance();const t=Os().custom.getInitialGlobalScene(()=>new Yi);this.globalSceneManager.changeScene(t),this.soundtrackManager=J.getInstance()}update(){this.globalSceneManager.update(),this.cursorMouseManager.update(),this.soundtrackManager.hasTrack&&this.soundtrackManager.currentTrack.update()}render(){this.renderProvider.clearScreen(),this.globalSceneManager.render()}runLoop(){requestAnimationFrame(()=>{this.fpsController.count(),this.runLoop()})}init(){this.runLoop()}}class Mr{static async init(){await Promise.all(Object.values(zi).map(t=>this.loadFont(t)))}static loadFont(t){return new Promise(e=>{const i=new FontFace(t,`url(${Gi(`fonts/${t}.ttf`)})`);document.fonts.add(i),i.load().then(()=>e())})}}async function Rr(){await d.init(),await Mr.init(),await ht.init(),await he.init()}async function vr(){await Rr(),new Lr().init()}window.addEventListener("DOMContentLoaded",()=>{vr()});
